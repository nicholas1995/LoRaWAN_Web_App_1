var cov_2r2386e950=function(){var path="/Users/nicholasmitchell/LoRaWAN_Web_App_1/server/src/policies/UpdatePasswordPolicy.js",hash="f949ac03a015103197d91c7f1863e447af3a3fa9",Function=function(){}.constructor,global=new Function('return this')(),gcv="__coverage__",coverageData={path:"/Users/nicholasmitchell/LoRaWAN_Web_App_1/server/src/policies/UpdatePasswordPolicy.js",statementMap:{"0":{start:{line:1,column:12},end:{line:1,column:26}},"1":{start:{line:3,column:0},end:{line:52,column:1}},"2":{start:{line:5,column:8},end:{line:7,column:9}},"3":{start:{line:8,column:23},end:{line:12,column:9}},"4":{start:{line:13,column:33},end:{line:13,column:59}},"5":{start:{line:14,column:8},end:{line:19,column:9}},"6":{start:{line:15,column:12},end:{line:15,column:35}},"7":{start:{line:16,column:12},end:{line:16,column:65}},"8":{start:{line:18,column:12},end:{line:18,column:19}},"9":{start:{line:22,column:19},end:{line:22,column:44}},"10":{start:{line:23,column:23},end:{line:30,column:9}},"11":{start:{line:31,column:33},end:{line:31,column:59}},"12":{start:{line:32,column:8},end:{line:49,column:9}},"13":{start:{line:33,column:12},end:{line:46,column:13}},"14":{start:{line:35,column:20},end:{line:35,column:47}},"15":{start:{line:36,column:20},end:{line:36,column:73}},"16":{start:{line:37,column:20},end:{line:37,column:26}},"17":{start:{line:39,column:20},end:{line:39,column:47}},"18":{start:{line:40,column:20},end:{line:40,column:77}},"19":{start:{line:41,column:20},end:{line:41,column:26}},"20":{start:{line:43,column:20},end:{line:43,column:39}},"21":{start:{line:44,column:20},end:{line:44,column:76}},"22":{start:{line:45,column:20},end:{line:45,column:26}},"23":{start:{line:48,column:12},end:{line:48,column:19}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:4,column:4},end:{line:4,column:5}},loc:{start:{line:4,column:37},end:{line:20,column:5}},line:4},"1":{name:"(anonymous_1)",decl:{start:{line:21,column:4},end:{line:21,column:5}},loc:{start:{line:21,column:36},end:{line:50,column:5}},line:21}},branchMap:{"0":{loc:{start:{line:14,column:8},end:{line:19,column:9}},type:"if",locations:[{start:{line:14,column:8},end:{line:19,column:9}},{start:{line:14,column:8},end:{line:19,column:9}}],line:14},"1":{loc:{start:{line:32,column:8},end:{line:49,column:9}},type:"if",locations:[{start:{line:32,column:8},end:{line:49,column:9}},{start:{line:32,column:8},end:{line:49,column:9}}],line:32},"2":{loc:{start:{line:33,column:12},end:{line:46,column:13}},type:"switch",locations:[{start:{line:34,column:16},end:{line:37,column:26}},{start:{line:38,column:16},end:{line:41,column:26}},{start:{line:42,column:16},end:{line:45,column:26}}],line:33}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0},f:{"0":0,"1":0},b:{"0":[0,0],"1":[0,0],"2":[0,0,0]},_coverageSchema:"43e27e138ebf9cfc5966b082cf9a028302ed4184"},coverage=global[gcv]||(global[gcv]={});if(coverage[path]&&coverage[path].hash===hash){return coverage[path];}coverageData.hash=hash;return coverage[path]=coverageData;}();const Joi=(cov_2r2386e950.s[0]++,require('joi'));cov_2r2386e950.s[1]++;module.exports={updateUserPassword(pw,res,next){cov_2r2386e950.f[0]++;cov_2r2386e950.s[2]++;data={//needs to be an object to get validated
pw:pw};const schema=(cov_2r2386e950.s[3]++,{pw:Joi.string().required().regex(new RegExp('^[a-zA-Z0-9\@\_\%\&]{8,32}$'))});const{error,value}=(cov_2r2386e950.s[4]++,Joi.validate(data,schema));cov_2r2386e950.s[5]++;if(error){cov_2r2386e950.b[0][0]++;cov_2r2386e950.s[6]++;console.log('Password');cov_2r2386e950.s[7]++;res.status(422).send({error:'Enter valid password'});}else{cov_2r2386e950.b[0][1]++;cov_2r2386e950.s[8]++;next();}},password_policy(req,res,next){cov_2r2386e950.f[1]++;let data=(cov_2r2386e950.s[9]++,JSON.parse(req.body.data));const schema=(cov_2r2386e950.s[10]++,{current_password:Joi.string().required().regex(new RegExp('^[a-zA-Z0-9\@\_\%\&]{8,32}$')),new_password:Joi.string().required().regex(new RegExp('^[a-zA-Z0-9\@\_\%\&]{8,32}$'))});const{error,value}=(cov_2r2386e950.s[11]++,Joi.validate(data,schema));cov_2r2386e950.s[12]++;if(error){cov_2r2386e950.b[1][0]++;cov_2r2386e950.s[13]++;switch(error.details[0].context.key){case'current_password':cov_2r2386e950.b[2][0]++;cov_2r2386e950.s[14]++;console.log('New Password');cov_2r2386e950.s[15]++;res.status(422).send({error:'Invalid password.'});cov_2r2386e950.s[16]++;break;case'new_password':cov_2r2386e950.b[2][1]++;cov_2r2386e950.s[17]++;console.log('New Password');cov_2r2386e950.s[18]++;res.status(422).send({error:'Invalid new password.'});cov_2r2386e950.s[19]++;break;default:cov_2r2386e950.b[2][2]++;cov_2r2386e950.s[20]++;console.log(error);cov_2r2386e950.s[21]++;res.status(422).send({error:'Invalid Information.'});cov_2r2386e950.s[22]++;break;}}else{cov_2r2386e950.b[1][1]++;cov_2r2386e950.s[23]++;next();}}};