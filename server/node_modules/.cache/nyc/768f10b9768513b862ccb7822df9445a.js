var cov_56x3pjfvl=function(){var path="/Users/nicholasmitchell/LoRaWAN_Web_App_1/server/src/controllers/user.js",hash="51f288deccc872682c819c4e405d5de69385bdaa",Function=function(){}.constructor,global=new Function('return this')(),gcv="__coverage__",coverageData={path:"/Users/nicholasmitchell/LoRaWAN_Web_App_1/server/src/controllers/user.js",statementMap:{"0":{start:{line:1,column:14},end:{line:1,column:42}},"1":{start:{line:2,column:13},end:{line:2,column:30}},"2":{start:{line:3,column:11},end:{line:3,column:27}},"3":{start:{line:4,column:12},end:{line:4,column:38}},"4":{start:{line:5,column:15},end:{line:5,column:39}},"5":{start:{line:6,column:29},end:{line:6,column:72}},"6":{start:{line:7,column:16},end:{line:7,column:56}},"7":{start:{line:8,column:19},end:{line:8,column:61}},"8":{start:{line:9,column:23},end:{line:9,column:69}},"9":{start:{line:10,column:37},end:{line:10,column:97}},"10":{start:{line:11,column:39},end:{line:11,column:101}},"11":{start:{line:18,column:2},end:{line:20,column:22}},"12":{start:{line:25,column:2},end:{line:29,column:4}},"13":{start:{line:32,column:2},end:{line:38,column:5}},"14":{start:{line:33,column:4},end:{line:37,column:7}},"15":{start:{line:34,column:6},end:{line:36,column:9}},"16":{start:{line:35,column:8},end:{line:35,column:24}},"17":{start:{line:43,column:2},end:{line:55,column:3}},"18":{start:{line:44,column:4},end:{line:52,column:7}},"19":{start:{line:45,column:6},end:{line:51,column:9}},"20":{start:{line:46,column:8},end:{line:50,column:9}},"21":{start:{line:47,column:10},end:{line:47,column:28}},"22":{start:{line:49,column:10},end:{line:49,column:28}},"23":{start:{line:54,column:4},end:{line:54,column:14}},"24":{start:{line:61,column:0},end:{line:702,column:2}},"25":{start:{line:65,column:4},end:{line:90,column:5}},"26":{start:{line:66,column:6},end:{line:85,column:7}},"27":{start:{line:67,column:8},end:{line:70,column:11}},"28":{start:{line:69,column:10},end:{line:69,column:20}},"29":{start:{line:71,column:8},end:{line:71,column:25}},"30":{start:{line:72,column:8},end:{line:79,column:9}},"31":{start:{line:80,column:12},end:{line:85,column:7}},"32":{start:{line:81,column:8},end:{line:84,column:12}},"33":{start:{line:83,column:12},end:{line:83,column:22}},"34":{start:{line:86,column:6},end:{line:86,column:36}},"35":{start:{line:87,column:6},end:{line:87,column:88}},"36":{start:{line:89,column:6},end:{line:89,column:78}},"37":{start:{line:93,column:4},end:{line:93,column:36}},"38":{start:{line:95,column:4},end:{line:119,column:5}},"39":{start:{line:96,column:8},end:{line:100,column:13}},"40":{start:{line:99,column:12},end:{line:99,column:22}},"41":{start:{line:101,column:8},end:{line:101,column:25}},"42":{start:{line:102,column:8},end:{line:114,column:9}},"43":{start:{line:115,column:6},end:{line:115,column:88}},"44":{start:{line:117,column:6},end:{line:117,column:22}},"45":{start:{line:118,column:6},end:{line:118,column:78}},"46":{start:{line:123,column:4},end:{line:175,column:5}},"47":{start:{line:124,column:17},end:{line:124,column:30}},"48":{start:{line:125,column:6},end:{line:128,column:9}},"49":{start:{line:127,column:8},end:{line:127,column:18}},"50":{start:{line:129,column:17},end:{line:134,column:10}},"51":{start:{line:133,column:10},end:{line:133,column:20}},"52":{start:{line:135,column:22},end:{line:138,column:7}},"53":{start:{line:139,column:19},end:{line:139,column:54}},"54":{start:{line:140,column:24},end:{line:152,column:9}},"55":{start:{line:153,column:8},end:{line:156,column:10}},"56":{start:{line:155,column:10},end:{line:155,column:20}},"57":{start:{line:157,column:8},end:{line:157,column:33}},"58":{start:{line:158,column:8},end:{line:162,column:10}},"59":{start:{line:161,column:10},end:{line:161,column:20}},"60":{start:{line:163,column:6},end:{line:171,column:7}},"61":{start:{line:164,column:8},end:{line:170,column:9}},"62":{start:{line:165,column:10},end:{line:169,column:14}},"63":{start:{line:168,column:14},end:{line:168,column:24}},"64":{start:{line:172,column:6},end:{line:172,column:73}},"65":{start:{line:174,column:6},end:{line:174,column:23}},"66":{start:{line:179,column:4},end:{line:216,column:5}},"67":{start:{line:180,column:8},end:{line:184,column:10}},"68":{start:{line:183,column:10},end:{line:183,column:20}},"69":{start:{line:185,column:24},end:{line:188,column:9}},"70":{start:{line:189,column:21},end:{line:189,column:56}},"71":{start:{line:190,column:26},end:{line:202,column:11}},"72":{start:{line:203,column:10},end:{line:206,column:14}},"73":{start:{line:205,column:14},end:{line:205,column:24}},"74":{start:{line:207,column:10},end:{line:211,column:12}},"75":{start:{line:210,column:12},end:{line:210,column:22}},"76":{start:{line:212,column:10},end:{line:212,column:35}},"77":{start:{line:213,column:10},end:{line:213,column:123}},"78":{start:{line:215,column:6},end:{line:215,column:22}},"79":{start:{line:219,column:4},end:{line:284,column:5}},"80":{start:{line:220,column:27},end:{line:220,column:31}},"81":{start:{line:221,column:21},end:{line:221,column:43}},"82":{start:{line:222,column:19},end:{line:226,column:8}},"83":{start:{line:225,column:8},end:{line:225,column:18}},"84":{start:{line:227,column:6},end:{line:273,column:7}},"85":{start:{line:231,column:8},end:{line:272,column:9}},"86":{start:{line:232,column:10},end:{line:232,column:95}},"87":{start:{line:234,column:35},end:{line:238,column:12}},"88":{start:{line:237,column:12},end:{line:237,column:22}},"89":{start:{line:239,column:10},end:{line:244,column:16}},"90":{start:{line:242,column:16},end:{line:242,column:35}},"91":{start:{line:243,column:16},end:{line:243,column:26}},"92":{start:{line:245,column:14},end:{line:249,column:18}},"93":{start:{line:248,column:18},end:{line:248,column:28}},"94":{start:{line:251,column:23},end:{line:256,column:12}},"95":{start:{line:254,column:12},end:{line:254,column:31}},"96":{start:{line:255,column:12},end:{line:255,column:22}},"97":{start:{line:257,column:25},end:{line:257,column:39}},"98":{start:{line:258,column:27},end:{line:264,column:17}},"99":{start:{line:265,column:22},end:{line:265,column:47}},"100":{start:{line:266,column:10},end:{line:266,column:32}},"101":{start:{line:267,column:10},end:{line:270,column:12}},"102":{start:{line:269,column:12},end:{line:269,column:22}},"103":{start:{line:271,column:10},end:{line:271,column:37}},"104":{start:{line:275,column:6},end:{line:275,column:22}},"105":{start:{line:276,column:6},end:{line:283,column:7}},"106":{start:{line:277,column:10},end:{line:277,column:85}},"107":{start:{line:279,column:11},end:{line:283,column:7}},"108":{start:{line:280,column:10},end:{line:280,column:93}},"109":{start:{line:282,column:10},end:{line:282,column:73}},"110":{start:{line:288,column:4},end:{line:316,column:5}},"111":{start:{line:289,column:17},end:{line:289,column:30}},"112":{start:{line:290,column:6},end:{line:294,column:11}},"113":{start:{line:293,column:10},end:{line:293,column:20}},"114":{start:{line:295,column:8},end:{line:303,column:9}},"115":{start:{line:296,column:10},end:{line:302,column:11}},"116":{start:{line:297,column:12},end:{line:301,column:17}},"117":{start:{line:300,column:16},end:{line:300,column:26}},"118":{start:{line:304,column:8},end:{line:312,column:7}},"119":{start:{line:305,column:10},end:{line:311,column:11}},"120":{start:{line:306,column:12},end:{line:310,column:17}},"121":{start:{line:309,column:16},end:{line:309,column:26}},"122":{start:{line:313,column:6},end:{line:313,column:74}},"123":{start:{line:315,column:6},end:{line:315,column:23}},"124":{start:{line:321,column:4},end:{line:335,column:5}},"125":{start:{line:322,column:6},end:{line:326,column:10}},"126":{start:{line:325,column:10},end:{line:325,column:20}},"127":{start:{line:327,column:6},end:{line:330,column:10}},"128":{start:{line:329,column:10},end:{line:329,column:20}},"129":{start:{line:331,column:6},end:{line:331,column:20}},"130":{start:{line:332,column:6},end:{line:332,column:88}},"131":{start:{line:334,column:6},end:{line:334,column:23}},"132":{start:{line:341,column:4},end:{line:351,column:5}},"133":{start:{line:342,column:6},end:{line:345,column:10}},"134":{start:{line:344,column:10},end:{line:344,column:20}},"135":{start:{line:346,column:6},end:{line:346,column:50}},"136":{start:{line:347,column:6},end:{line:347,column:109}},"137":{start:{line:349,column:6},end:{line:349,column:23}},"138":{start:{line:350,column:6},end:{line:350,column:85}},"139":{start:{line:356,column:4},end:{line:402,column:5}},"140":{start:{line:357,column:17},end:{line:357,column:42}},"141":{start:{line:358,column:19},end:{line:362,column:10}},"142":{start:{line:361,column:10},end:{line:361,column:20}},"143":{start:{line:363,column:6},end:{line:399,column:7}},"144":{start:{line:364,column:8},end:{line:364,column:73}},"145":{start:{line:367,column:8},end:{line:397,column:9}},"146":{start:{line:368,column:10},end:{line:368,column:118}},"147":{start:{line:369,column:14},end:{line:397,column:9}},"148":{start:{line:370,column:10},end:{line:370,column:138}},"149":{start:{line:372,column:30},end:{line:376,column:12}},"150":{start:{line:375,column:12},end:{line:375,column:22}},"151":{start:{line:377,column:8},end:{line:396,column:9}},"152":{start:{line:378,column:10},end:{line:392,column:11}},"153":{start:{line:379,column:12},end:{line:379,column:50}},"154":{start:{line:382,column:27},end:{line:382,column:41}},"155":{start:{line:383,column:23},end:{line:389,column:13}},"156":{start:{line:390,column:12},end:{line:390,column:40}},"157":{start:{line:391,column:12},end:{line:391,column:39}},"158":{start:{line:395,column:10},end:{line:395,column:75}},"159":{start:{line:401,column:6},end:{line:401,column:23}},"160":{start:{line:407,column:4},end:{line:455,column:5}},"161":{start:{line:408,column:6},end:{line:408,column:39}},"162":{start:{line:409,column:19},end:{line:413,column:10}},"163":{start:{line:412,column:10},end:{line:412,column:20}},"164":{start:{line:414,column:6},end:{line:452,column:7}},"165":{start:{line:415,column:8},end:{line:415,column:73}},"166":{start:{line:418,column:28},end:{line:422,column:12}},"167":{start:{line:421,column:12},end:{line:421,column:22}},"168":{start:{line:423,column:8},end:{line:451,column:9}},"169":{start:{line:424,column:10},end:{line:447,column:12}},"170":{start:{line:425,column:37},end:{line:429,column:16}},"171":{start:{line:428,column:16},end:{line:428,column:26}},"172":{start:{line:430,column:12},end:{line:434,column:16}},"173":{start:{line:433,column:16},end:{line:433,column:26}},"174":{start:{line:435,column:27},end:{line:435,column:41}},"175":{start:{line:436,column:12},end:{line:442,column:14}},"176":{start:{line:443,column:12},end:{line:443,column:40}},"177":{start:{line:444,column:12},end:{line:444,column:39}},"178":{start:{line:446,column:12},end:{line:446,column:28}},"179":{start:{line:450,column:10},end:{line:450,column:75}},"180":{start:{line:460,column:4},end:{line:483,column:5}},"181":{start:{line:461,column:6},end:{line:465,column:10}},"182":{start:{line:464,column:10},end:{line:464,column:20}},"183":{start:{line:466,column:6},end:{line:466,column:45}},"184":{start:{line:467,column:6},end:{line:477,column:7}},"185":{start:{line:478,column:6},end:{line:478,column:58}},"186":{start:{line:479,column:6},end:{line:479,column:47}},"187":{start:{line:481,column:6},end:{line:481,column:23}},"188":{start:{line:482,column:6},end:{line:482,column:62}},"189":{start:{line:487,column:4},end:{line:499,column:5}},"190":{start:{line:488,column:6},end:{line:488,column:51}},"191":{start:{line:489,column:6},end:{line:492,column:11}},"192":{start:{line:491,column:10},end:{line:491,column:20}},"193":{start:{line:493,column:17},end:{line:493,column:96}},"194":{start:{line:494,column:6},end:{line:494,column:34}},"195":{start:{line:495,column:6},end:{line:495,column:35}},"196":{start:{line:498,column:6},end:{line:498,column:23}},"197":{start:{line:503,column:4},end:{line:533,column:5}},"198":{start:{line:504,column:6},end:{line:504,column:39}},"199":{start:{line:505,column:19},end:{line:509,column:10}},"200":{start:{line:508,column:10},end:{line:508,column:20}},"201":{start:{line:510,column:26},end:{line:514,column:10}},"202":{start:{line:513,column:10},end:{line:513,column:20}},"203":{start:{line:515,column:6},end:{line:530,column:7}},"204":{start:{line:516,column:35},end:{line:520,column:14}},"205":{start:{line:519,column:14},end:{line:519,column:24}},"206":{start:{line:521,column:8},end:{line:525,column:14}},"207":{start:{line:524,column:14},end:{line:524,column:24}},"208":{start:{line:526,column:8},end:{line:526,column:62}},"209":{start:{line:529,column:8},end:{line:529,column:64}},"210":{start:{line:532,column:6},end:{line:532,column:23}},"211":{start:{line:537,column:4},end:{line:590,column:5}},"212":{start:{line:538,column:19},end:{line:542,column:10}},"213":{start:{line:541,column:10},end:{line:541,column:20}},"214":{start:{line:543,column:6},end:{line:586,column:7}},"215":{start:{line:544,column:8},end:{line:544,column:163}},"216":{start:{line:545,column:12},end:{line:586,column:7}},"217":{start:{line:546,column:8},end:{line:546,column:108}},"218":{start:{line:548,column:8},end:{line:585,column:9}},"219":{start:{line:549,column:10},end:{line:549,column:129}},"220":{start:{line:551,column:26},end:{line:554,column:11}},"221":{start:{line:555,column:23},end:{line:555,column:55}},"222":{start:{line:556,column:28},end:{line:568,column:13}},"223":{start:{line:569,column:12},end:{line:572,column:16}},"224":{start:{line:571,column:16},end:{line:571,column:26}},"225":{start:{line:573,column:12},end:{line:577,column:16}},"226":{start:{line:576,column:16},end:{line:576,column:26}},"227":{start:{line:578,column:14},end:{line:582,column:16}},"228":{start:{line:581,column:16},end:{line:581,column:26}},"229":{start:{line:583,column:10},end:{line:583,column:35}},"230":{start:{line:584,column:10},end:{line:584,column:165}},"231":{start:{line:589,column:6},end:{line:589,column:22}},"232":{start:{line:594,column:4},end:{line:631,column:5}},"233":{start:{line:595,column:6},end:{line:599,column:8}},"234":{start:{line:598,column:8},end:{line:598,column:18}},"235":{start:{line:600,column:26},end:{line:603,column:11}},"236":{start:{line:604,column:23},end:{line:604,column:55}},"237":{start:{line:605,column:28},end:{line:617,column:13}},"238":{start:{line:618,column:31},end:{line:621,column:16}},"239":{start:{line:620,column:16},end:{line:620,column:26}},"240":{start:{line:622,column:14},end:{line:626,column:16}},"241":{start:{line:625,column:16},end:{line:625,column:26}},"242":{start:{line:627,column:10},end:{line:627,column:35}},"243":{start:{line:628,column:10},end:{line:628,column:119}},"244":{start:{line:630,column:6},end:{line:630,column:22}},"245":{start:{line:634,column:4},end:{line:699,column:5}},"246":{start:{line:635,column:27},end:{line:635,column:31}},"247":{start:{line:636,column:21},end:{line:636,column:47}},"248":{start:{line:637,column:19},end:{line:641,column:8}},"249":{start:{line:640,column:8},end:{line:640,column:18}},"250":{start:{line:642,column:6},end:{line:688,column:7}},"251":{start:{line:646,column:8},end:{line:687,column:9}},"252":{start:{line:647,column:10},end:{line:647,column:94}},"253":{start:{line:649,column:35},end:{line:653,column:12}},"254":{start:{line:652,column:12},end:{line:652,column:22}},"255":{start:{line:654,column:10},end:{line:659,column:16}},"256":{start:{line:657,column:16},end:{line:657,column:35}},"257":{start:{line:658,column:16},end:{line:658,column:26}},"258":{start:{line:660,column:14},end:{line:664,column:18}},"259":{start:{line:663,column:18},end:{line:663,column:28}},"260":{start:{line:666,column:23},end:{line:671,column:12}},"261":{start:{line:669,column:12},end:{line:669,column:31}},"262":{start:{line:670,column:12},end:{line:670,column:22}},"263":{start:{line:672,column:25},end:{line:672,column:39}},"264":{start:{line:673,column:27},end:{line:679,column:17}},"265":{start:{line:680,column:22},end:{line:680,column:47}},"266":{start:{line:681,column:10},end:{line:681,column:32}},"267":{start:{line:682,column:10},end:{line:685,column:12}},"268":{start:{line:684,column:12},end:{line:684,column:22}},"269":{start:{line:686,column:10},end:{line:686,column:37}},"270":{start:{line:690,column:6},end:{line:690,column:22}},"271":{start:{line:691,column:6},end:{line:698,column:7}},"272":{start:{line:692,column:10},end:{line:692,column:85}},"273":{start:{line:694,column:11},end:{line:698,column:7}},"274":{start:{line:695,column:10},end:{line:695,column:93}},"275":{start:{line:697,column:10},end:{line:697,column:73}}},fnMap:{"0":{name:"randomPasswordGenerator",decl:{start:{line:17,column:9},end:{line:17,column:32}},loc:{start:{line:17,column:35},end:{line:21,column:1}},line:17},"1":{name:"toJSON",decl:{start:{line:23,column:9},end:{line:23,column:15}},loc:{start:{line:23,column:22},end:{line:30,column:1}},line:23},"2":{name:"encrypt",decl:{start:{line:31,column:9},end:{line:31,column:16}},loc:{start:{line:31,column:27},end:{line:39,column:1}},line:31},"3":{name:"(anonymous_3)",decl:{start:{line:32,column:21},end:{line:32,column:22}},loc:{start:{line:32,column:42},end:{line:38,column:3}},line:32},"4":{name:"(anonymous_4)",decl:{start:{line:33,column:22},end:{line:33,column:23}},loc:{start:{line:33,column:41},end:{line:37,column:5}},line:33},"5":{name:"(anonymous_5)",decl:{start:{line:34,column:42},end:{line:34,column:43}},loc:{start:{line:34,column:61},end:{line:36,column:7}},line:34},"6":{name:"compare",decl:{start:{line:42,column:9},end:{line:42,column:16}},loc:{start:{line:42,column:34},end:{line:56,column:1}},line:42},"7":{name:"(anonymous_7)",decl:{start:{line:44,column:23},end:{line:44,column:24}},loc:{start:{line:44,column:44},end:{line:52,column:5}},line:44},"8":{name:"(anonymous_8)",decl:{start:{line:45,column:38},end:{line:45,column:39}},loc:{start:{line:45,column:57},end:{line:51,column:7}},line:45},"9":{name:"(anonymous_9)",decl:{start:{line:63,column:7},end:{line:63,column:8}},loc:{start:{line:63,column:33},end:{line:91,column:3}},line:63},"10":{name:"(anonymous_10)",decl:{start:{line:67,column:64},end:{line:67,column:65}},loc:{start:{line:67,column:71},end:{line:70,column:9}},line:67},"11":{name:"(anonymous_11)",decl:{start:{line:82,column:17},end:{line:82,column:18}},loc:{start:{line:82,column:26},end:{line:84,column:11}},line:82},"12":{name:"(anonymous_12)",decl:{start:{line:92,column:11},end:{line:92,column:12}},loc:{start:{line:92,column:37},end:{line:120,column:3}},line:92},"13":{name:"(anonymous_13)",decl:{start:{line:97,column:17},end:{line:97,column:18}},loc:{start:{line:97,column:24},end:{line:100,column:11}},line:97},"14":{name:"(anonymous_14)",decl:{start:{line:122,column:10},end:{line:122,column:11}},loc:{start:{line:122,column:34},end:{line:176,column:3}},line:122},"15":{name:"(anonymous_15)",decl:{start:{line:126,column:13},end:{line:126,column:14}},loc:{start:{line:126,column:22},end:{line:128,column:7}},line:126},"16":{name:"(anonymous_16)",decl:{start:{line:130,column:15},end:{line:130,column:16}},loc:{start:{line:130,column:22},end:{line:134,column:9}},line:130},"17":{name:"(anonymous_17)",decl:{start:{line:154,column:15},end:{line:154,column:16}},loc:{start:{line:154,column:22},end:{line:156,column:9}},line:154},"18":{name:"(anonymous_18)",decl:{start:{line:159,column:15},end:{line:159,column:16}},loc:{start:{line:159,column:22},end:{line:162,column:9}},line:159},"19":{name:"(anonymous_19)",decl:{start:{line:166,column:19},end:{line:166,column:20}},loc:{start:{line:166,column:26},end:{line:169,column:13}},line:166},"20":{name:"(anonymous_20)",decl:{start:{line:177,column:36},end:{line:177,column:37}},loc:{start:{line:177,column:89},end:{line:217,column:3}},line:177},"21":{name:"(anonymous_21)",decl:{start:{line:181,column:15},end:{line:181,column:16}},loc:{start:{line:181,column:22},end:{line:184,column:9}},line:181},"22":{name:"(anonymous_22)",decl:{start:{line:204,column:19},end:{line:204,column:20}},loc:{start:{line:204,column:26},end:{line:206,column:13}},line:204},"23":{name:"(anonymous_23)",decl:{start:{line:208,column:17},end:{line:208,column:18}},loc:{start:{line:208,column:24},end:{line:211,column:11}},line:208},"24":{name:"(anonymous_24)",decl:{start:{line:218,column:20},end:{line:218,column:21}},loc:{start:{line:218,column:44},end:{line:285,column:3}},line:218},"25":{name:"(anonymous_25)",decl:{start:{line:223,column:13},end:{line:223,column:14}},loc:{start:{line:223,column:20},end:{line:226,column:7}},line:223},"26":{name:"(anonymous_26)",decl:{start:{line:235,column:17},end:{line:235,column:18}},loc:{start:{line:235,column:24},end:{line:238,column:11}},line:235},"27":{name:"(anonymous_27)",decl:{start:{line:240,column:21},end:{line:240,column:22}},loc:{start:{line:240,column:28},end:{line:244,column:15}},line:240},"28":{name:"(anonymous_28)",decl:{start:{line:246,column:23},end:{line:246,column:24}},loc:{start:{line:246,column:30},end:{line:249,column:17}},line:246},"29":{name:"(anonymous_29)",decl:{start:{line:252,column:17},end:{line:252,column:18}},loc:{start:{line:252,column:24},end:{line:256,column:11}},line:252},"30":{name:"(anonymous_30)",decl:{start:{line:268,column:17},end:{line:268,column:18}},loc:{start:{line:268,column:24},end:{line:270,column:11}},line:268},"31":{name:"(anonymous_31)",decl:{start:{line:287,column:10},end:{line:287,column:11}},loc:{start:{line:287,column:36},end:{line:317,column:3}},line:287},"32":{name:"(anonymous_32)",decl:{start:{line:291,column:15},end:{line:291,column:16}},loc:{start:{line:291,column:22},end:{line:294,column:9}},line:291},"33":{name:"(anonymous_33)",decl:{start:{line:298,column:21},end:{line:298,column:22}},loc:{start:{line:298,column:28},end:{line:301,column:15}},line:298},"34":{name:"(anonymous_34)",decl:{start:{line:307,column:21},end:{line:307,column:22}},loc:{start:{line:307,column:28},end:{line:310,column:15}},line:307},"35":{name:"(anonymous_35)",decl:{start:{line:319,column:10},end:{line:319,column:11}},loc:{start:{line:319,column:36},end:{line:336,column:3}},line:319},"36":{name:"(anonymous_36)",decl:{start:{line:323,column:15},end:{line:323,column:16}},loc:{start:{line:323,column:22},end:{line:326,column:9}},line:323},"37":{name:"(anonymous_37)",decl:{start:{line:328,column:15},end:{line:328,column:16}},loc:{start:{line:328,column:24},end:{line:330,column:9}},line:328},"38":{name:"(anonymous_38)",decl:{start:{line:339,column:20},end:{line:339,column:21}},loc:{start:{line:339,column:46},end:{line:352,column:3}},line:339},"39":{name:"(anonymous_39)",decl:{start:{line:343,column:15},end:{line:343,column:16}},loc:{start:{line:343,column:24},end:{line:345,column:9}},line:343},"40":{name:"(anonymous_40)",decl:{start:{line:355,column:13},end:{line:355,column:14}},loc:{start:{line:355,column:37},end:{line:403,column:3}},line:355},"41":{name:"(anonymous_41)",decl:{start:{line:359,column:15},end:{line:359,column:16}},loc:{start:{line:359,column:22},end:{line:362,column:9}},line:359},"42":{name:"(anonymous_42)",decl:{start:{line:373,column:17},end:{line:373,column:18}},loc:{start:{line:373,column:24},end:{line:376,column:11}},line:373},"43":{name:"(anonymous_43)",decl:{start:{line:405,column:18},end:{line:405,column:19}},loc:{start:{line:405,column:42},end:{line:456,column:3}},line:405},"44":{name:"(anonymous_44)",decl:{start:{line:410,column:15},end:{line:410,column:16}},loc:{start:{line:410,column:22},end:{line:413,column:9}},line:410},"45":{name:"(anonymous_45)",decl:{start:{line:419,column:17},end:{line:419,column:18}},loc:{start:{line:419,column:24},end:{line:422,column:11}},line:419},"46":{name:"(anonymous_46)",decl:{start:{line:424,column:74},end:{line:424,column:75}},loc:{start:{line:424,column:91},end:{line:445,column:11}},line:424},"47":{name:"(anonymous_47)",decl:{start:{line:426,column:21},end:{line:426,column:22}},loc:{start:{line:426,column:28},end:{line:429,column:15}},line:426},"48":{name:"(anonymous_48)",decl:{start:{line:431,column:21},end:{line:431,column:22}},loc:{start:{line:431,column:28},end:{line:434,column:15}},line:431},"49":{name:"(anonymous_49)",decl:{start:{line:445,column:19},end:{line:445,column:20}},loc:{start:{line:445,column:26},end:{line:447,column:11}},line:445},"50":{name:"(anonymous_50)",decl:{start:{line:458,column:15},end:{line:458,column:16}},loc:{start:{line:458,column:38},end:{line:484,column:3}},line:458},"51":{name:"(anonymous_51)",decl:{start:{line:462,column:15},end:{line:462,column:16}},loc:{start:{line:462,column:22},end:{line:465,column:9}},line:462},"52":{name:"(anonymous_52)",decl:{start:{line:485,column:18},end:{line:485,column:19}},loc:{start:{line:485,column:42},end:{line:500,column:3}},line:485},"53":{name:"(anonymous_53)",decl:{start:{line:490,column:15},end:{line:490,column:16}},loc:{start:{line:490,column:22},end:{line:492,column:9}},line:490},"54":{name:"(anonymous_54)",decl:{start:{line:501,column:27},end:{line:501,column:28}},loc:{start:{line:501,column:51},end:{line:534,column:3}},line:501},"55":{name:"(anonymous_55)",decl:{start:{line:506,column:15},end:{line:506,column:16}},loc:{start:{line:506,column:22},end:{line:509,column:9}},line:506},"56":{name:"(anonymous_56)",decl:{start:{line:511,column:15},end:{line:511,column:16}},loc:{start:{line:511,column:22},end:{line:514,column:9}},line:511},"57":{name:"(anonymous_57)",decl:{start:{line:517,column:19},end:{line:517,column:20}},loc:{start:{line:517,column:26},end:{line:520,column:13}},line:517},"58":{name:"(anonymous_58)",decl:{start:{line:522,column:19},end:{line:522,column:20}},loc:{start:{line:522,column:26},end:{line:525,column:13}},line:522},"59":{name:"(anonymous_59)",decl:{start:{line:535,column:26},end:{line:535,column:27}},loc:{start:{line:535,column:50},end:{line:591,column:3}},line:535},"60":{name:"(anonymous_60)",decl:{start:{line:539,column:15},end:{line:539,column:16}},loc:{start:{line:539,column:22},end:{line:542,column:9}},line:539},"61":{name:"(anonymous_61)",decl:{start:{line:570,column:21},end:{line:570,column:22}},loc:{start:{line:570,column:28},end:{line:572,column:15}},line:570},"62":{name:"(anonymous_62)",decl:{start:{line:574,column:21},end:{line:574,column:22}},loc:{start:{line:574,column:28},end:{line:577,column:15}},line:574},"63":{name:"(anonymous_63)",decl:{start:{line:579,column:21},end:{line:579,column:22}},loc:{start:{line:579,column:28},end:{line:582,column:15}},line:579},"64":{name:"(anonymous_64)",decl:{start:{line:592,column:34},end:{line:592,column:35}},loc:{start:{line:592,column:87},end:{line:632,column:3}},line:592},"65":{name:"(anonymous_65)",decl:{start:{line:596,column:13},end:{line:596,column:14}},loc:{start:{line:596,column:20},end:{line:599,column:7}},line:596},"66":{name:"(anonymous_66)",decl:{start:{line:619,column:21},end:{line:619,column:22}},loc:{start:{line:619,column:28},end:{line:621,column:15}},line:619},"67":{name:"(anonymous_67)",decl:{start:{line:623,column:21},end:{line:623,column:22}},loc:{start:{line:623,column:28},end:{line:626,column:15}},line:623},"68":{name:"(anonymous_68)",decl:{start:{line:633,column:18},end:{line:633,column:19}},loc:{start:{line:633,column:42},end:{line:700,column:3}},line:633},"69":{name:"(anonymous_69)",decl:{start:{line:638,column:13},end:{line:638,column:14}},loc:{start:{line:638,column:20},end:{line:641,column:7}},line:638},"70":{name:"(anonymous_70)",decl:{start:{line:650,column:17},end:{line:650,column:18}},loc:{start:{line:650,column:24},end:{line:653,column:11}},line:650},"71":{name:"(anonymous_71)",decl:{start:{line:655,column:21},end:{line:655,column:22}},loc:{start:{line:655,column:28},end:{line:659,column:15}},line:655},"72":{name:"(anonymous_72)",decl:{start:{line:661,column:23},end:{line:661,column:24}},loc:{start:{line:661,column:30},end:{line:664,column:17}},line:661},"73":{name:"(anonymous_73)",decl:{start:{line:667,column:17},end:{line:667,column:18}},loc:{start:{line:667,column:24},end:{line:671,column:11}},line:667},"74":{name:"(anonymous_74)",decl:{start:{line:683,column:17},end:{line:683,column:18}},loc:{start:{line:683,column:24},end:{line:685,column:11}},line:683}},branchMap:{"0":{loc:{start:{line:46,column:8},end:{line:50,column:9}},type:"if",locations:[{start:{line:46,column:8},end:{line:50,column:9}},{start:{line:46,column:8},end:{line:50,column:9}}],line:46},"1":{loc:{start:{line:66,column:6},end:{line:85,column:7}},type:"if",locations:[{start:{line:66,column:6},end:{line:85,column:7}},{start:{line:66,column:6},end:{line:85,column:7}}],line:66},"2":{loc:{start:{line:80,column:12},end:{line:85,column:7}},type:"if",locations:[{start:{line:80,column:12},end:{line:85,column:7}},{start:{line:80,column:12},end:{line:85,column:7}}],line:80},"3":{loc:{start:{line:163,column:6},end:{line:171,column:7}},type:"if",locations:[{start:{line:163,column:6},end:{line:171,column:7}},{start:{line:163,column:6},end:{line:171,column:7}}],line:163},"4":{loc:{start:{line:227,column:6},end:{line:273,column:7}},type:"if",locations:[{start:{line:227,column:6},end:{line:273,column:7}},{start:{line:227,column:6},end:{line:273,column:7}}],line:227},"5":{loc:{start:{line:231,column:8},end:{line:272,column:9}},type:"if",locations:[{start:{line:231,column:8},end:{line:272,column:9}},{start:{line:231,column:8},end:{line:272,column:9}}],line:231},"6":{loc:{start:{line:276,column:6},end:{line:283,column:7}},type:"if",locations:[{start:{line:276,column:6},end:{line:283,column:7}},{start:{line:276,column:6},end:{line:283,column:7}}],line:276},"7":{loc:{start:{line:279,column:11},end:{line:283,column:7}},type:"if",locations:[{start:{line:279,column:11},end:{line:283,column:7}},{start:{line:279,column:11},end:{line:283,column:7}}],line:279},"8":{loc:{start:{line:295,column:8},end:{line:303,column:9}},type:"if",locations:[{start:{line:295,column:8},end:{line:303,column:9}},{start:{line:295,column:8},end:{line:303,column:9}}],line:295},"9":{loc:{start:{line:304,column:8},end:{line:312,column:7}},type:"if",locations:[{start:{line:304,column:8},end:{line:312,column:7}},{start:{line:304,column:8},end:{line:312,column:7}}],line:304},"10":{loc:{start:{line:363,column:6},end:{line:399,column:7}},type:"if",locations:[{start:{line:363,column:6},end:{line:399,column:7}},{start:{line:363,column:6},end:{line:399,column:7}}],line:363},"11":{loc:{start:{line:367,column:8},end:{line:397,column:9}},type:"if",locations:[{start:{line:367,column:8},end:{line:397,column:9}},{start:{line:367,column:8},end:{line:397,column:9}}],line:367},"12":{loc:{start:{line:369,column:14},end:{line:397,column:9}},type:"if",locations:[{start:{line:369,column:14},end:{line:397,column:9}},{start:{line:369,column:14},end:{line:397,column:9}}],line:369},"13":{loc:{start:{line:377,column:8},end:{line:396,column:9}},type:"if",locations:[{start:{line:377,column:8},end:{line:396,column:9}},{start:{line:377,column:8},end:{line:396,column:9}}],line:377},"14":{loc:{start:{line:378,column:10},end:{line:392,column:11}},type:"if",locations:[{start:{line:378,column:10},end:{line:392,column:11}},{start:{line:378,column:10},end:{line:392,column:11}}],line:378},"15":{loc:{start:{line:414,column:6},end:{line:452,column:7}},type:"if",locations:[{start:{line:414,column:6},end:{line:452,column:7}},{start:{line:414,column:6},end:{line:452,column:7}}],line:414},"16":{loc:{start:{line:423,column:8},end:{line:451,column:9}},type:"if",locations:[{start:{line:423,column:8},end:{line:451,column:9}},{start:{line:423,column:8},end:{line:451,column:9}}],line:423},"17":{loc:{start:{line:515,column:6},end:{line:530,column:7}},type:"if",locations:[{start:{line:515,column:6},end:{line:530,column:7}},{start:{line:515,column:6},end:{line:530,column:7}}],line:515},"18":{loc:{start:{line:543,column:6},end:{line:586,column:7}},type:"if",locations:[{start:{line:543,column:6},end:{line:586,column:7}},{start:{line:543,column:6},end:{line:586,column:7}}],line:543},"19":{loc:{start:{line:545,column:12},end:{line:586,column:7}},type:"if",locations:[{start:{line:545,column:12},end:{line:586,column:7}},{start:{line:545,column:12},end:{line:586,column:7}}],line:545},"20":{loc:{start:{line:548,column:8},end:{line:585,column:9}},type:"if",locations:[{start:{line:548,column:8},end:{line:585,column:9}},{start:{line:548,column:8},end:{line:585,column:9}}],line:548},"21":{loc:{start:{line:642,column:6},end:{line:688,column:7}},type:"if",locations:[{start:{line:642,column:6},end:{line:688,column:7}},{start:{line:642,column:6},end:{line:688,column:7}}],line:642},"22":{loc:{start:{line:646,column:8},end:{line:687,column:9}},type:"if",locations:[{start:{line:646,column:8},end:{line:687,column:9}},{start:{line:646,column:8},end:{line:687,column:9}}],line:646},"23":{loc:{start:{line:691,column:6},end:{line:698,column:7}},type:"if",locations:[{start:{line:691,column:6},end:{line:698,column:7}},{start:{line:691,column:6},end:{line:698,column:7}}],line:691},"24":{loc:{start:{line:694,column:11},end:{line:698,column:7}},type:"if",locations:[{start:{line:694,column:11},end:{line:698,column:7}},{start:{line:694,column:11},end:{line:698,column:7}}],line:694}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0,"86":0,"87":0,"88":0,"89":0,"90":0,"91":0,"92":0,"93":0,"94":0,"95":0,"96":0,"97":0,"98":0,"99":0,"100":0,"101":0,"102":0,"103":0,"104":0,"105":0,"106":0,"107":0,"108":0,"109":0,"110":0,"111":0,"112":0,"113":0,"114":0,"115":0,"116":0,"117":0,"118":0,"119":0,"120":0,"121":0,"122":0,"123":0,"124":0,"125":0,"126":0,"127":0,"128":0,"129":0,"130":0,"131":0,"132":0,"133":0,"134":0,"135":0,"136":0,"137":0,"138":0,"139":0,"140":0,"141":0,"142":0,"143":0,"144":0,"145":0,"146":0,"147":0,"148":0,"149":0,"150":0,"151":0,"152":0,"153":0,"154":0,"155":0,"156":0,"157":0,"158":0,"159":0,"160":0,"161":0,"162":0,"163":0,"164":0,"165":0,"166":0,"167":0,"168":0,"169":0,"170":0,"171":0,"172":0,"173":0,"174":0,"175":0,"176":0,"177":0,"178":0,"179":0,"180":0,"181":0,"182":0,"183":0,"184":0,"185":0,"186":0,"187":0,"188":0,"189":0,"190":0,"191":0,"192":0,"193":0,"194":0,"195":0,"196":0,"197":0,"198":0,"199":0,"200":0,"201":0,"202":0,"203":0,"204":0,"205":0,"206":0,"207":0,"208":0,"209":0,"210":0,"211":0,"212":0,"213":0,"214":0,"215":0,"216":0,"217":0,"218":0,"219":0,"220":0,"221":0,"222":0,"223":0,"224":0,"225":0,"226":0,"227":0,"228":0,"229":0,"230":0,"231":0,"232":0,"233":0,"234":0,"235":0,"236":0,"237":0,"238":0,"239":0,"240":0,"241":0,"242":0,"243":0,"244":0,"245":0,"246":0,"247":0,"248":0,"249":0,"250":0,"251":0,"252":0,"253":0,"254":0,"255":0,"256":0,"257":0,"258":0,"259":0,"260":0,"261":0,"262":0,"263":0,"264":0,"265":0,"266":0,"267":0,"268":0,"269":0,"270":0,"271":0,"272":0,"273":0,"274":0,"275":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0],"20":[0,0],"21":[0,0],"22":[0,0],"23":[0,0],"24":[0,0]},_coverageSchema:"43e27e138ebf9cfc5966b082cf9a028302ed4184"},coverage=global[gcv]||(global[gcv]={});if(coverage[path]&&coverage[path].hash===hash){return coverage[path];}coverageData.hash=hash;return coverage[path]=coverageData;}();const email=(cov_56x3pjfvl.s[0]++,require("../services/email"));const Math=(cov_56x3pjfvl.s[1]++,require("mathjs"));const db=(cov_56x3pjfvl.s[2]++,require("../db"));const jwt=(cov_56x3pjfvl.s[3]++,require("../services/jwt"));const bcrypt=(cov_56x3pjfvl.s[4]++,require("bcrypt-nodejs"));const UpdatePasswordPolicy=(cov_56x3pjfvl.s[5]++,require("../policies/UpdatePasswordPolicy"));const user_db=(cov_56x3pjfvl.s[6]++,require('../services/database/users_db'));const devices_db=(cov_56x3pjfvl.s[7]++,require("../services/database/devices_db"));const USER_VESSEL_DB=(cov_56x3pjfvl.s[8]++,require("../services/database/user_vessel_db"));const db_user_reset_password_token=(cov_56x3pjfvl.s[9]++,require("../services/database/user_reset_password_token_db"));const db_activate_user_account_token=(cov_56x3pjfvl.s[10]++,require("../services/database/activate_user_account_token_db"));//Creates a random password of length 8 using characters 0-9 and
function randomPasswordGenerator(){cov_56x3pjfvl.f[0]++;cov_56x3pjfvl.s[11]++;return Math.random(0,2).toString(36).substring(2,10);}function toJSON(user){cov_56x3pjfvl.f[1]++;cov_56x3pjfvl.s[12]++;//this converts the user data returned from the database query to a json object
return{id:user[0].id,email:user[0].email,user_class:user[0].user_class};}function encrypt(password){cov_56x3pjfvl.f[2]++;cov_56x3pjfvl.s[13]++;return new Promise((resolve,reject)=>{cov_56x3pjfvl.f[3]++;cov_56x3pjfvl.s[14]++;bcrypt.genSalt(5,(error,result)=>{cov_56x3pjfvl.f[4]++;cov_56x3pjfvl.s[15]++;bcrypt.hash(password,result,null,(error,result)=>{cov_56x3pjfvl.f[5]++;cov_56x3pjfvl.s[16]++;resolve(result);});});});}//Function compares the plain text password and the encryted password stored in the 
//database and returns 1 if they are the same and 0 if they are different 
function compare(data,encrypted){cov_56x3pjfvl.f[6]++;cov_56x3pjfvl.s[17]++;try{cov_56x3pjfvl.s[18]++;return new Promise((resolve,reject)=>{cov_56x3pjfvl.f[7]++;cov_56x3pjfvl.s[19]++;bcrypt.compare(data,encrypted,(error,result)=>{cov_56x3pjfvl.f[8]++;cov_56x3pjfvl.s[20]++;if(result==true){cov_56x3pjfvl.b[0][0]++;cov_56x3pjfvl.s[21]++;return resolve(1);}else{cov_56x3pjfvl.b[0][1]++;cov_56x3pjfvl.s[22]++;return resolve(0);}});});}catch(err){cov_56x3pjfvl.s[23]++;throw err;}}//---------------------------------------------------------------------------------------------------------------------------------------------------------------------
//---------------------------------------------------------------------------------------------------------------------------------------------------------------------
cov_56x3pjfvl.s[24]++;module.exports={//Get Users
get:async function(req,res){cov_56x3pjfvl.f[9]++;let users;cov_56x3pjfvl.s[25]++;try{cov_56x3pjfvl.s[26]++;if(req.access=='self'){cov_56x3pjfvl.b[1][0]++;cov_56x3pjfvl.s[27]++;users=await user_db.get_profile(req.user.email).catch(err=>{cov_56x3pjfvl.f[10]++;cov_56x3pjfvl.s[28]++;//Error fetching user profile information from database
throw err;});cov_56x3pjfvl.s[29]++;users=users[0];cov_56x3pjfvl.s[30]++;users={first_name:users.first_name,last_name:users.last_name,address:users.address,home_phone:users.home_phone,mobile_phone:users.mobile_phone,email:users.email};}else{cov_56x3pjfvl.b[1][1]++;cov_56x3pjfvl.s[31]++;if(req.access=='all'){cov_56x3pjfvl.b[2][0]++;cov_56x3pjfvl.s[32]++;users=await user_db.get_users().catch(err=>{cov_56x3pjfvl.f[11]++;cov_56x3pjfvl.s[33]++;throw err;});}else{cov_56x3pjfvl.b[2][1]++;}}cov_56x3pjfvl.s[34]++;users=JSON.stringify(users);cov_56x3pjfvl.s[35]++;res.status(200).send({users:users,message:'Users fetched',type:'success'});}catch(err){cov_56x3pjfvl.s[36]++;res.status(500).send({message:"Failed to get users",type:'error'});}},get_one:async function(req,res){cov_56x3pjfvl.f[12]++;cov_56x3pjfvl.s[37]++;console.log(req.params.user_id);let users;cov_56x3pjfvl.s[38]++;try{cov_56x3pjfvl.s[39]++;users=await user_db.get_user(req.params.user_id).catch(err=>{cov_56x3pjfvl.f[13]++;cov_56x3pjfvl.s[40]++;//Error fetching user account information from database
throw err;});cov_56x3pjfvl.s[41]++;users=users[0];cov_56x3pjfvl.s[42]++;users={user_id:users.id,first_name:users.first_name,last_name:users.last_name,user_country:users.user_country,user_city:users.user_city,user_district:users.user_district,user_street:users.user_street,home_phone:users.home_phone,mobile_phone:users.mobile_phone,user_class:users.user_class,email:users.email};cov_56x3pjfvl.s[43]++;res.status(200).send({users:users,message:'Users fetched',type:'success'});}catch(err){cov_56x3pjfvl.s[44]++;console.log(err);cov_56x3pjfvl.s[45]++;res.status(500).send({message:"Failed to get users",type:'error'});}},//Add User
create:async function(req,res){cov_56x3pjfvl.f[14]++;cov_56x3pjfvl.s[46]++;try{let data=(cov_56x3pjfvl.s[47]++,req.body.user);cov_56x3pjfvl.s[48]++;await user_db.add_user(data,'null').catch(err=>{cov_56x3pjfvl.f[15]++;cov_56x3pjfvl.s[49]++;throw err;});let user=(cov_56x3pjfvl.s[50]++,await user_db.get_profile(data.email).catch(err=>{cov_56x3pjfvl.f[16]++;cov_56x3pjfvl.s[51]++;//Error fetching the user account information of the previously created account
//We do this to get the id of the associated account.
throw err;}));let user_JSON=(cov_56x3pjfvl.s[52]++,{email:`${data.email}`,user_id:`${user[0].id}`});let token=(cov_56x3pjfvl.s[53]++,jwt.jwt_activate_account(user_JSON));var mailOptions=(cov_56x3pjfvl.s[54]++,{from:'lorawanconsole@gmail.com',to:data.email,subject:'Activate Account',html:`<h2>Good Day ${data.first_name},</h2> 
        <p>An account has been created using your email address for the Private Marine IoT Network Web Based Console.<br> 
        You have been granted ${data.user_class} privilages. Click <b><a href="http://localhost:8081/#/user/activate/${token}">here</a></b> to activate your account and create a password.<br>
        <b>This link is only valid for the next 48 hours.</b>
        </p>
        
        Thank You,<br>
        The Private Marine IoT Network Web Based Console Team`});cov_56x3pjfvl.s[55]++;await email.transporter.sendMail(mailOptions).catch(err=>{cov_56x3pjfvl.f[17]++;cov_56x3pjfvl.s[56]++;throw err;});cov_56x3pjfvl.s[57]++;console.log('email sent');cov_56x3pjfvl.s[58]++;await db_activate_user_account_token.create_activate_user_account_token(token,user[0].id).catch(err=>{cov_56x3pjfvl.f[18]++;cov_56x3pjfvl.s[59]++;//Error creating token in black list
throw err;});cov_56x3pjfvl.s[60]++;if(data.vessels.length>0){cov_56x3pjfvl.b[3][0]++;cov_56x3pjfvl.s[61]++;for(let i=0;i<data.vessels.length;i++){cov_56x3pjfvl.s[62]++;await USER_VESSEL_DB.create_user_vessel_relationship(user[0].id,data.vessels[i]).catch(err=>{cov_56x3pjfvl.f[19]++;cov_56x3pjfvl.s[63]++;//Error adding a user device eui to the database
throw err;});}}else{cov_56x3pjfvl.b[3][1]++;};cov_56x3pjfvl.s[64]++;res.status(200).send({message:'User created.',type:'success'});}catch(err){cov_56x3pjfvl.s[65]++;console.log(err);}},resend_activate_account_request:async function(req,res,token_old,user_information){cov_56x3pjfvl.f[20]++;cov_56x3pjfvl.s[66]++;//This resends the email to the user to activate their acount after the initial link expired
try{cov_56x3pjfvl.s[67]++;await db_activate_user_account_token.delete_activate_user_account_token(token_old).catch(err=>{cov_56x3pjfvl.f[21]++;cov_56x3pjfvl.s[68]++;//Error deleting token in black list
throw err;});let user_JSON=(cov_56x3pjfvl.s[69]++,{email:`${user_information.email}`,user_id:`${user_information.user_id}`});let token=(cov_56x3pjfvl.s[70]++,jwt.jwt_activate_account(user_JSON));var mailOptions=(cov_56x3pjfvl.s[71]++,{from:'lorawanconsole@gmail.com',to:user_information.email,subject:'Activate Account',html:`<h2>Good Day,</h2> 
          <p>An account has been created using your email address for the Private Marine IoT Network Web Based Console.<br> 
          However, the previous link expired. Please click <b><a href="http://localhost:8081/#/user/activate/${token}">here</a></b> to activate your account and create a password.<br>
          <b>This link is only valid for the next 48 hours.</b>
          </p>
          
          Thank You,<br>
          The Private Marine IoT Network Web Based Console Team`});cov_56x3pjfvl.s[72]++;await email.transporter.sendMail(mailOptions).catch(err=>{cov_56x3pjfvl.f[22]++;cov_56x3pjfvl.s[73]++;throw err;});cov_56x3pjfvl.s[74]++;await db_activate_user_account_token.create_activate_user_account_token(token,user_information.user_id).catch(err=>{cov_56x3pjfvl.f[23]++;cov_56x3pjfvl.s[75]++;//Error creating token in black list
throw err;});cov_56x3pjfvl.s[76]++;console.log('Email Sent');cov_56x3pjfvl.s[77]++;res.status(401).send({error:"Token previously expired. Please check email for new account activation link."});}catch(err){cov_56x3pjfvl.s[78]++;console.log(err);}},activate_account:async function(req,res){cov_56x3pjfvl.f[24]++;cov_56x3pjfvl.s[79]++;try{let error_location=(cov_56x3pjfvl.s[80]++,null);let password=(cov_56x3pjfvl.s[81]++,req.body.data.password);let result=(cov_56x3pjfvl.s[82]++,await user_db.get_profile(req.user.email).catch(err=>{cov_56x3pjfvl.f[25]++;cov_56x3pjfvl.s[83]++;//Error getting user form database using email to find
throw err;}));cov_56x3pjfvl.s[84]++;if(result==""){//Email does not exists 
cov_56x3pjfvl.b[4][0]++;}else{cov_56x3pjfvl.b[4][1]++;cov_56x3pjfvl.s[85]++;if(result[0].user_account_activation==1){cov_56x3pjfvl.b[5][0]++;cov_56x3pjfvl.s[86]++;//Correct email but account already activated
res.status(403).send({message:"Account already activated. This is an old link."});}else{cov_56x3pjfvl.b[5][1]++;let encrypted_password=(cov_56x3pjfvl.s[87]++,await encrypt(password).catch(err=>{cov_56x3pjfvl.f[26]++;cov_56x3pjfvl.s[88]++;//Error encrypting pw
throw err;}));cov_56x3pjfvl.s[89]++;await user_db.update_user_pw(encrypted_password,req.user.email).catch(err=>{cov_56x3pjfvl.f[27]++;cov_56x3pjfvl.s[90]++;//Error updating user pw
error_location=0;cov_56x3pjfvl.s[91]++;throw err;});cov_56x3pjfvl.s[92]++;await user_db.activate_user_account(req.user.email).catch(err=>{cov_56x3pjfvl.f[28]++;cov_56x3pjfvl.s[93]++;//Error setting user_account_activation flag
throw err;});//Password Updated.... Now we are going to login the user
let result=(cov_56x3pjfvl.s[94]++,await user_db.get_profile(req.user.email).catch(err=>{cov_56x3pjfvl.f[29]++;cov_56x3pjfvl.s[95]++;//Error getting user form database using email to find(Password updated)
error_location=1;cov_56x3pjfvl.s[96]++;throw err;}));let userJSON=(cov_56x3pjfvl.s[97]++,toJSON(result));let data=(cov_56x3pjfvl.s[98]++,{user:userJSON,user_class:result[0].user_class,token:jwt.jwtUserSignin(userJSON),message:'Successful Login',user_name:result[0].first_name+" "+result[0].last_name});let token=(cov_56x3pjfvl.s[99]++,req.headers.authorization);cov_56x3pjfvl.s[100]++;token=token.slice(7);cov_56x3pjfvl.s[101]++;await db_activate_user_account_token.delete_activate_user_account_token(token).catch(err=>{cov_56x3pjfvl.f[30]++;cov_56x3pjfvl.s[102]++;throw err;});cov_56x3pjfvl.s[103]++;res.status(200).send(data);}}}catch(err){cov_56x3pjfvl.s[104]++;console.log(err);cov_56x3pjfvl.s[105]++;if(error_location==0){cov_56x3pjfvl.b[6][0]++;cov_56x3pjfvl.s[106]++;res.status(500).send({message:"Failed update password",type:'error'});}else{cov_56x3pjfvl.b[6][1]++;cov_56x3pjfvl.s[107]++;if(error_location==1){cov_56x3pjfvl.b[7][0]++;cov_56x3pjfvl.s[108]++;res.status(200).send({message:"Password Updated. Failed to login",type:'info'});}else{cov_56x3pjfvl.b[7][1]++;cov_56x3pjfvl.s[109]++;res.status(500).send({message:'Server Error',type:'error'});}}}},//Update User
update:async function(req,res){cov_56x3pjfvl.f[31]++;cov_56x3pjfvl.s[110]++;try{let data=(cov_56x3pjfvl.s[111]++,req.body.user);cov_56x3pjfvl.s[112]++;await user_db.update_user(data,req.params.user_id).catch(err=>{cov_56x3pjfvl.f[32]++;cov_56x3pjfvl.s[113]++;//Error updating user on the database
throw err;});cov_56x3pjfvl.s[114]++;if(data.vessels.deleted.length>0){cov_56x3pjfvl.b[8][0]++;cov_56x3pjfvl.s[115]++;for(let i=0;i<data.vessels.deleted.length;i++){cov_56x3pjfvl.s[116]++;await USER_VESSEL_DB.delete_user_vessel_relationship(req.params.user_id,data.vessels.deleted[i]).catch(err=>{cov_56x3pjfvl.f[33]++;cov_56x3pjfvl.s[117]++;//Error deleting user vessel relationship
throw err;});}}else{cov_56x3pjfvl.b[8][1]++;}cov_56x3pjfvl.s[118]++;if(data.vessels.added.length>0){cov_56x3pjfvl.b[9][0]++;cov_56x3pjfvl.s[119]++;for(let i=0;i<data.vessels.added.length;i++){cov_56x3pjfvl.s[120]++;await USER_VESSEL_DB.create_user_vessel_relationship(req.params.user_id,data.vessels.added[i]).catch(err=>{cov_56x3pjfvl.f[34]++;cov_56x3pjfvl.s[121]++;//Error deleting user vessel relationship
throw err;});}}else{cov_56x3pjfvl.b[9][1]++;}cov_56x3pjfvl.s[122]++;res.status(200).send({message:'User updated.',type:'success'});}catch(err){cov_56x3pjfvl.s[123]++;console.log(err);}},//Delete User
delete:async function(req,res){cov_56x3pjfvl.f[35]++;let users;cov_56x3pjfvl.s[124]++;try{cov_56x3pjfvl.s[125]++;await user_db.delete_user(req.params.id).catch(err=>{cov_56x3pjfvl.f[36]++;cov_56x3pjfvl.s[126]++;//Error deleting user
throw err;});cov_56x3pjfvl.s[127]++;users=await user_db.get_users().catch(err=>{cov_56x3pjfvl.f[37]++;cov_56x3pjfvl.s[128]++;throw err;});cov_56x3pjfvl.s[129]++;users=users;cov_56x3pjfvl.s[130]++;res.status(200).send({users:users,message:'User deleted.',type:'success'});}catch(err){cov_56x3pjfvl.s[131]++;console.log(err);}},//Get User Vessels (devices associated with a fisher)
get_user_vessels:async function(req,res){cov_56x3pjfvl.f[38]++;let user_vessels;cov_56x3pjfvl.s[132]++;try{cov_56x3pjfvl.s[133]++;user_vessels=await USER_VESSEL_DB.get_user_vessels_not_deleted(req.params.user_id).catch(err=>{cov_56x3pjfvl.f[39]++;cov_56x3pjfvl.s[134]++;throw err;});cov_56x3pjfvl.s[135]++;user_vessels=JSON.stringify(user_vessels);cov_56x3pjfvl.s[136]++;res.status(200).send({user_vessels:user_vessels,message:'User vessels fetched',type:'success'});}catch(err){cov_56x3pjfvl.s[137]++;console.log(err);cov_56x3pjfvl.s[138]++;res.status(500).send({message:"Failed to get user vessels",type:'error'});}},//Login New
login_new:async function(req,res){cov_56x3pjfvl.f[40]++;cov_56x3pjfvl.s[139]++;try{let data=(cov_56x3pjfvl.s[140]++,JSON.parse(req.body.data));let result=(cov_56x3pjfvl.s[141]++,await user_db.get_profile(data.email).catch(err=>{cov_56x3pjfvl.f[41]++;cov_56x3pjfvl.s[142]++;//Error getting user form database using email to find
throw err;}));cov_56x3pjfvl.s[143]++;if(result==""){cov_56x3pjfvl.b[10][0]++;cov_56x3pjfvl.s[144]++;//Email does not exists
res.status(403).send({message:"Incorrect login credentials"});}else{cov_56x3pjfvl.b[10][1]++;cov_56x3pjfvl.s[145]++;if(result[0].user_reset_password==1){cov_56x3pjfvl.b[11][0]++;cov_56x3pjfvl.s[146]++;//Correct email but password requested to be reset. PREVENT LOGIN
res.status(403).send({message:"Password requested to be changed. Please check email for instructions."});}else{cov_56x3pjfvl.b[11][1]++;cov_56x3pjfvl.s[147]++;if(result[0].user_account_activation==0){cov_56x3pjfvl.b[12][0]++;cov_56x3pjfvl.s[148]++;//Correct email but account not activated
res.status(403).send({message:"Please check email address for link to activte your account. Once activated you can login."});}else{cov_56x3pjfvl.b[12][1]++;let encryted_data=(cov_56x3pjfvl.s[149]++,await compare(data.password,result[0].password).catch(err=>{cov_56x3pjfvl.f[42]++;cov_56x3pjfvl.s[150]++;//Error checking to see if passwords are the same
throw err;}));cov_56x3pjfvl.s[151]++;if(encryted_data==1){cov_56x3pjfvl.b[13][0]++;cov_56x3pjfvl.s[152]++;//Correct login credentials
if(result[0].new_user==1){cov_56x3pjfvl.b[14][0]++;cov_56x3pjfvl.s[153]++;//New User
res.status(409).send({new_user:1});}else{cov_56x3pjfvl.b[14][1]++;//Existing user
let userJSON=(cov_56x3pjfvl.s[154]++,toJSON(result));let data=(cov_56x3pjfvl.s[155]++,{user:userJSON,user_class:result[0].user_class,token:jwt.jwtUserSignin(userJSON),message:'Successful Login',user_name:result[0].first_name+" "+result[0].last_name});cov_56x3pjfvl.s[156]++;data=JSON.stringify(data);cov_56x3pjfvl.s[157]++;res.status(200).send(data);}}else{cov_56x3pjfvl.b[13][1]++;cov_56x3pjfvl.s[158]++;//Incorrect PW;
res.status(403).send({message:"Incorrect login credentials"});}}}}}catch(err){cov_56x3pjfvl.s[159]++;console.log(err);}},//Login New User
login_new_user:async function(req,res){cov_56x3pjfvl.f[43]++;let data;cov_56x3pjfvl.s[160]++;try{cov_56x3pjfvl.s[161]++;data=JSON.parse(req.body.data);let result=(cov_56x3pjfvl.s[162]++,await user_db.get_profile(data.email).catch(err=>{cov_56x3pjfvl.f[44]++;cov_56x3pjfvl.s[163]++;//Error getting user form database using email to find
throw err;}));cov_56x3pjfvl.s[164]++;if(result==""){cov_56x3pjfvl.b[15][0]++;cov_56x3pjfvl.s[165]++;//Email does not exists
res.status(403).send({message:"Incorrect login credentials"});}else{cov_56x3pjfvl.b[15][1]++;let encryted_data=(cov_56x3pjfvl.s[166]++,await compare(data.password,result[0].password).catch(err=>{cov_56x3pjfvl.f[45]++;cov_56x3pjfvl.s[167]++;//Error checking to see if passwords are the same
throw err;}));cov_56x3pjfvl.s[168]++;if(encryted_data==1){cov_56x3pjfvl.b[16][0]++;cov_56x3pjfvl.s[169]++;//Correct login credentials
UpdatePasswordPolicy.updateUserPassword(data.new_password,res,async function(){cov_56x3pjfvl.f[46]++;let encrypted_password=(cov_56x3pjfvl.s[170]++,await encrypt(data.new_password).catch(err=>{cov_56x3pjfvl.f[47]++;cov_56x3pjfvl.s[171]++;//Error encrypting pw
throw err;}));cov_56x3pjfvl.s[172]++;await user_db.update_user_pw(encrypted_password,data.email).catch(err=>{cov_56x3pjfvl.f[48]++;cov_56x3pjfvl.s[173]++;//Error updating user pw
throw err;});let userJSON=(cov_56x3pjfvl.s[174]++,toJSON(result));cov_56x3pjfvl.s[175]++;data={user:userJSON,user_class:result[0].user_class,token:jwt.jwtUserSignin(userJSON),message:'Successful Login',user_name:result[0].first_name+" "+result[0].last_name};cov_56x3pjfvl.s[176]++;data=JSON.stringify(data);cov_56x3pjfvl.s[177]++;res.status(200).send(data);}).catch(err=>{cov_56x3pjfvl.f[49]++;cov_56x3pjfvl.s[178]++;console.log(err);});}else{cov_56x3pjfvl.b[16][1]++;cov_56x3pjfvl.s[179]++;//Incorrect PW;
res.status(403).send({message:"Incorrect login credentials"});}}}catch(err){}},//Get Profile Information
profile_get:async function(req,res){cov_56x3pjfvl.f[50]++;let user_information;cov_56x3pjfvl.s[180]++;try{cov_56x3pjfvl.s[181]++;user_information=await user_db.get_profile(req.user.email).catch(err=>{cov_56x3pjfvl.f[51]++;cov_56x3pjfvl.s[182]++;//Error fetching user profile information from database
throw err;});cov_56x3pjfvl.s[183]++;user_information=user_information[0];cov_56x3pjfvl.s[184]++;user_information={first_name:user_information.first_name,last_name:user_information.last_name,user_country:user_information.user_country,user_city:user_information.user_city,user_district:user_information.user_district,user_street:user_information.user_street,home_phone:user_information.home_phone,mobile_phone:user_information.mobile_phone,email:user_information.email};cov_56x3pjfvl.s[185]++;user_information=JSON.stringify(user_information);cov_56x3pjfvl.s[186]++;res.status(200).send({user_information});}catch(err){cov_56x3pjfvl.s[187]++;console.log(err);cov_56x3pjfvl.s[188]++;console.log('Error trying to send profile information');}},profile_update:async function(req,res){cov_56x3pjfvl.f[52]++;let user_information;cov_56x3pjfvl.s[189]++;try{cov_56x3pjfvl.s[190]++;user_information=JSON.parse(req.body.data);cov_56x3pjfvl.s[191]++;await user_db.update_profile(user_information).catch(err=>{cov_56x3pjfvl.f[53]++;cov_56x3pjfvl.s[192]++;throw err;});let data=(cov_56x3pjfvl.s[193]++,{user_name:user_information.first_name+" "+user_information.last_name});cov_56x3pjfvl.s[194]++;data=JSON.stringify(data);cov_56x3pjfvl.s[195]++;res.status(200).send({data});}catch(err){cov_56x3pjfvl.s[196]++;console.log(err);}},profile_update_password:async function(req,res){cov_56x3pjfvl.f[54]++;let data;cov_56x3pjfvl.s[197]++;try{cov_56x3pjfvl.s[198]++;data=JSON.parse(req.body.data);let result=(cov_56x3pjfvl.s[199]++,await user_db.get_profile(req.user.email).catch(err=>{cov_56x3pjfvl.f[55]++;cov_56x3pjfvl.s[200]++;//Error getting user form database using email to find
throw err;}));let encryted_data=(cov_56x3pjfvl.s[201]++,await compare(data.current_password,result[0].password).catch(err=>{cov_56x3pjfvl.f[56]++;cov_56x3pjfvl.s[202]++;//Error checking to see if passwords are the same
throw err;}));cov_56x3pjfvl.s[203]++;if(encryted_data==1){cov_56x3pjfvl.b[17][0]++;//Correct login credentials
let encrypted_password=(cov_56x3pjfvl.s[204]++,await encrypt(data.new_password).catch(err=>{cov_56x3pjfvl.f[57]++;cov_56x3pjfvl.s[205]++;//Error encrypting pw
throw err;}));cov_56x3pjfvl.s[206]++;await user_db.update_user_pw(encrypted_password,req.user.email).catch(err=>{cov_56x3pjfvl.f[58]++;cov_56x3pjfvl.s[207]++;//Error updating user pw
throw err;});cov_56x3pjfvl.s[208]++;res.status(200).send({message:"Password Updated"});}else{cov_56x3pjfvl.b[17][1]++;cov_56x3pjfvl.s[209]++;//Incorrect PW;
res.status(403).send({message:"Incorrect password"});}}catch(err){cov_56x3pjfvl.s[210]++;console.log(err);}},reset_password_request:async function(req,res){cov_56x3pjfvl.f[59]++;cov_56x3pjfvl.s[211]++;//This sends the email to the user to reset their password
try{let result=(cov_56x3pjfvl.s[212]++,await user_db.get_profile(req.body.email).catch(err=>{cov_56x3pjfvl.f[60]++;cov_56x3pjfvl.s[213]++;//Error getting user form database using email to find
throw err;}));cov_56x3pjfvl.s[214]++;if(result==""){cov_56x3pjfvl.b[18][0]++;cov_56x3pjfvl.s[215]++;//Email does not exists (sends this message so they user will not be able to fish for emails)
res.status(403).send({message:"Check email for instructions to reset your password. If no email received ensure that email entered above is correct."});}else{cov_56x3pjfvl.b[18][1]++;cov_56x3pjfvl.s[216]++;if(result[0].user_account_activation==0){cov_56x3pjfvl.b[19][0]++;cov_56x3pjfvl.s[217]++;//Correct email but account not activated
res.status(403).send({message:"Account not activated. Please check email for activation link."});}else{cov_56x3pjfvl.b[19][1]++;cov_56x3pjfvl.s[218]++;if(result[0].user_reset_password==1){cov_56x3pjfvl.b[20][0]++;cov_56x3pjfvl.s[219]++;//Correct email but password requested to be reset. PREVENT LOGIN
res.status(403).send({message:"Password previously requested to be changed. Please check email for instructions."});}else{cov_56x3pjfvl.b[20][1]++;let user_JSON=(cov_56x3pjfvl.s[220]++,{email:`${req.body.email}`,user_id:`${result[0].id}`});let token=(cov_56x3pjfvl.s[221]++,jwt.jwt_user_reset_pw(user_JSON));var mailOptions=(cov_56x3pjfvl.s[222]++,{from:'lorawanconsole@gmail.com',to:req.body.email,subject:'Password Reset',html:`<h2>Good Day ${result[0].first_name},</h2> 
            <p>You recently requested to reset your password for your Private Marine IoT Network Web Based Console account.
            <br> Click <b><a href="http://localhost:8081/#/user/reset_password/${token}">here</a></b> to reset it. 
            <b>This password reset link is only valid for the next 24 hours.</b>
            </p>
  
            Thank You,<br>
            The Private Marine IoT Network Web Based Console Team`});cov_56x3pjfvl.s[223]++;await email.transporter.sendMail(mailOptions).catch(err=>{cov_56x3pjfvl.f[61]++;cov_56x3pjfvl.s[224]++;throw err;});cov_56x3pjfvl.s[225]++;await user_db.update_user_reset_password(req.body.email,1).catch(err=>{cov_56x3pjfvl.f[62]++;cov_56x3pjfvl.s[226]++;//Error setting user_reset_password flag
throw err;});cov_56x3pjfvl.s[227]++;await db_user_reset_password_token.create_user_reset_password_token(token,result[0].id).catch(err=>{cov_56x3pjfvl.f[63]++;cov_56x3pjfvl.s[228]++;//Error creating token in black list
throw err;});cov_56x3pjfvl.s[229]++;console.log('Email Sent');cov_56x3pjfvl.s[230]++;res.status(403).send({message:"Check email for instructions to reset your password. If no email received ensure that email entered above is correct."});}}}}catch(err){cov_56x3pjfvl.s[231]++;console.log(err);}},resend_reset_password_request:async function(req,res,token_old,user_information){cov_56x3pjfvl.f[64]++;cov_56x3pjfvl.s[232]++;//This resends the email to the user to reset their password after the initial one expired
try{cov_56x3pjfvl.s[233]++;await db_user_reset_password_token.delete_user_reset_password_token(token_old).catch(err=>{cov_56x3pjfvl.f[65]++;cov_56x3pjfvl.s[234]++;//Error creating token in black list
throw err;});let user_JSON=(cov_56x3pjfvl.s[235]++,{email:`${user_information.email}`,user_id:`${user_information.user_id}`});let token=(cov_56x3pjfvl.s[236]++,jwt.jwt_user_reset_pw(user_JSON));var mailOptions=(cov_56x3pjfvl.s[237]++,{from:'lorawanconsole@gmail.com',to:user_information.email,subject:'Password Reset',html:`<h2>Good Day,</h2> 
            <p>You recently requested to reset your password for your Private Marine IoT Network Web Based Console account.
            <br>Click <b><a href="http://localhost:8081/#/user/reset_password/${token}">here</a></b> to reset it. 
            <b>This password reset link is only valid for the next 24 hours.</b>
            </p>
  
            Thank You,<br>
            The Private Marine IoT Network Web Based Console Team`});let email_result=(cov_56x3pjfvl.s[238]++,await email.transporter.sendMail(mailOptions).catch(err=>{cov_56x3pjfvl.f[66]++;cov_56x3pjfvl.s[239]++;throw err;}));cov_56x3pjfvl.s[240]++;await db_user_reset_password_token.create_user_reset_password_token(token,user_information.user_id).catch(err=>{cov_56x3pjfvl.f[67]++;cov_56x3pjfvl.s[241]++;//Error creating token in black list 
throw err;});cov_56x3pjfvl.s[242]++;console.log('Email Sent');cov_56x3pjfvl.s[243]++;res.status(401).send({error:"Token previously expired. Please check email for new reset password link."});}catch(err){cov_56x3pjfvl.s[244]++;console.log(err);}},reset_password:async function(req,res){cov_56x3pjfvl.f[68]++;cov_56x3pjfvl.s[245]++;try{let error_location=(cov_56x3pjfvl.s[246]++,null);let password=(cov_56x3pjfvl.s[247]++,req.body.data.new_password);let result=(cov_56x3pjfvl.s[248]++,await user_db.get_profile(req.user.email).catch(err=>{cov_56x3pjfvl.f[69]++;cov_56x3pjfvl.s[249]++;//Error getting user form database using email to find
throw err;}));cov_56x3pjfvl.s[250]++;if(result==""){//Email does not exists 
cov_56x3pjfvl.b[21][0]++;}else{cov_56x3pjfvl.b[21][1]++;cov_56x3pjfvl.s[251]++;if(result[0].user_reset_password==0){cov_56x3pjfvl.b[22][0]++;cov_56x3pjfvl.s[252]++;//Correct email but password requested to be reset. PREVENT changing password again
res.status(403).send({message:"Password already updated. This is an old link!"});}else{cov_56x3pjfvl.b[22][1]++;let encrypted_password=(cov_56x3pjfvl.s[253]++,await encrypt(password).catch(err=>{cov_56x3pjfvl.f[70]++;cov_56x3pjfvl.s[254]++;//Error encrypting pw
throw err;}));cov_56x3pjfvl.s[255]++;await user_db.update_user_pw(encrypted_password,req.user.email).catch(err=>{cov_56x3pjfvl.f[71]++;cov_56x3pjfvl.s[256]++;//Error updating user pw
error_location=0;cov_56x3pjfvl.s[257]++;throw err;});cov_56x3pjfvl.s[258]++;await user_db.update_user_reset_password(req.user.email,0).catch(err=>{cov_56x3pjfvl.f[72]++;cov_56x3pjfvl.s[259]++;//Error setting user_reset_password flag
throw err;});//Password Updated.... Now we are going to login the user
let result=(cov_56x3pjfvl.s[260]++,await user_db.get_profile(req.user.email).catch(err=>{cov_56x3pjfvl.f[73]++;cov_56x3pjfvl.s[261]++;//Error getting user form database using email to find(Password updated)
error_location=1;cov_56x3pjfvl.s[262]++;throw err;}));let userJSON=(cov_56x3pjfvl.s[263]++,toJSON(result));let data=(cov_56x3pjfvl.s[264]++,{user:userJSON,user_class:result[0].user_class,token:jwt.jwtUserSignin(userJSON),message:'Successful Login',user_name:result[0].first_name+" "+result[0].last_name});let token=(cov_56x3pjfvl.s[265]++,req.headers.authorization);cov_56x3pjfvl.s[266]++;token=token.slice(7);cov_56x3pjfvl.s[267]++;await db_user_reset_password_token.delete_user_reset_password_token(token).catch(err=>{cov_56x3pjfvl.f[74]++;cov_56x3pjfvl.s[268]++;throw err;});cov_56x3pjfvl.s[269]++;res.status(200).send(data);}}}catch(err){cov_56x3pjfvl.s[270]++;console.log(err);cov_56x3pjfvl.s[271]++;if(error_location==0){cov_56x3pjfvl.b[23][0]++;cov_56x3pjfvl.s[272]++;res.status(500).send({message:"Failed update password",type:'error'});}else{cov_56x3pjfvl.b[23][1]++;cov_56x3pjfvl.s[273]++;if(error_location==1){cov_56x3pjfvl.b[24][0]++;cov_56x3pjfvl.s[274]++;res.status(200).send({message:"Password Updated. Failed to login",type:'info'});}else{cov_56x3pjfvl.b[24][1]++;cov_56x3pjfvl.s[275]++;res.status(500).send({message:'Server Error',type:'error'});}}}}};