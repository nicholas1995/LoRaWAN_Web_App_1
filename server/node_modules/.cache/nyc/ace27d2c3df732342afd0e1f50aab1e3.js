var cov_56x3pjfvl=function(){var path="/Users/nicholasmitchell/LoRaWAN_Web_App_1/server/src/controllers/user.js",hash="700f8f5249cac29b9d8b95a5eddefeb8b8496cb0",Function=function(){}.constructor,global=new Function('return this')(),gcv="__coverage__",coverageData={path:"/Users/nicholasmitchell/LoRaWAN_Web_App_1/server/src/controllers/user.js",statementMap:{"0":{start:{line:1,column:14},end:{line:1,column:42}},"1":{start:{line:2,column:13},end:{line:2,column:30}},"2":{start:{line:3,column:11},end:{line:3,column:27}},"3":{start:{line:4,column:12},end:{line:4,column:38}},"4":{start:{line:5,column:15},end:{line:5,column:39}},"5":{start:{line:6,column:29},end:{line:6,column:72}},"6":{start:{line:7,column:16},end:{line:7,column:56}},"7":{start:{line:8,column:19},end:{line:8,column:61}},"8":{start:{line:9,column:23},end:{line:9,column:69}},"9":{start:{line:10,column:37},end:{line:10,column:97}},"10":{start:{line:11,column:39},end:{line:11,column:101}},"11":{start:{line:18,column:2},end:{line:20,column:22}},"12":{start:{line:25,column:2},end:{line:29,column:4}},"13":{start:{line:32,column:2},end:{line:38,column:5}},"14":{start:{line:33,column:4},end:{line:37,column:7}},"15":{start:{line:34,column:6},end:{line:36,column:9}},"16":{start:{line:35,column:8},end:{line:35,column:24}},"17":{start:{line:43,column:2},end:{line:55,column:3}},"18":{start:{line:44,column:4},end:{line:52,column:7}},"19":{start:{line:45,column:6},end:{line:51,column:9}},"20":{start:{line:46,column:8},end:{line:50,column:9}},"21":{start:{line:47,column:10},end:{line:47,column:28}},"22":{start:{line:49,column:10},end:{line:49,column:28}},"23":{start:{line:54,column:4},end:{line:54,column:14}},"24":{start:{line:61,column:0},end:{line:701,column:2}},"25":{start:{line:65,column:4},end:{line:90,column:5}},"26":{start:{line:66,column:6},end:{line:85,column:7}},"27":{start:{line:67,column:8},end:{line:70,column:11}},"28":{start:{line:69,column:10},end:{line:69,column:20}},"29":{start:{line:71,column:8},end:{line:71,column:25}},"30":{start:{line:72,column:8},end:{line:79,column:9}},"31":{start:{line:80,column:12},end:{line:85,column:7}},"32":{start:{line:81,column:8},end:{line:84,column:12}},"33":{start:{line:83,column:12},end:{line:83,column:22}},"34":{start:{line:86,column:6},end:{line:86,column:36}},"35":{start:{line:87,column:6},end:{line:87,column:88}},"36":{start:{line:89,column:6},end:{line:89,column:78}},"37":{start:{line:94,column:4},end:{line:118,column:5}},"38":{start:{line:95,column:8},end:{line:99,column:13}},"39":{start:{line:98,column:12},end:{line:98,column:22}},"40":{start:{line:100,column:8},end:{line:100,column:25}},"41":{start:{line:101,column:8},end:{line:113,column:9}},"42":{start:{line:114,column:6},end:{line:114,column:88}},"43":{start:{line:116,column:6},end:{line:116,column:22}},"44":{start:{line:117,column:6},end:{line:117,column:78}},"45":{start:{line:122,column:4},end:{line:174,column:5}},"46":{start:{line:123,column:17},end:{line:123,column:30}},"47":{start:{line:124,column:6},end:{line:127,column:9}},"48":{start:{line:126,column:8},end:{line:126,column:18}},"49":{start:{line:128,column:17},end:{line:133,column:10}},"50":{start:{line:132,column:10},end:{line:132,column:20}},"51":{start:{line:134,column:22},end:{line:137,column:7}},"52":{start:{line:138,column:19},end:{line:138,column:54}},"53":{start:{line:139,column:24},end:{line:151,column:9}},"54":{start:{line:152,column:8},end:{line:155,column:10}},"55":{start:{line:154,column:10},end:{line:154,column:20}},"56":{start:{line:156,column:8},end:{line:156,column:33}},"57":{start:{line:157,column:8},end:{line:161,column:10}},"58":{start:{line:160,column:10},end:{line:160,column:20}},"59":{start:{line:162,column:6},end:{line:170,column:7}},"60":{start:{line:163,column:8},end:{line:169,column:9}},"61":{start:{line:164,column:10},end:{line:168,column:14}},"62":{start:{line:167,column:14},end:{line:167,column:24}},"63":{start:{line:171,column:6},end:{line:171,column:73}},"64":{start:{line:173,column:6},end:{line:173,column:86}},"65":{start:{line:178,column:4},end:{line:215,column:5}},"66":{start:{line:179,column:8},end:{line:183,column:10}},"67":{start:{line:182,column:10},end:{line:182,column:20}},"68":{start:{line:184,column:24},end:{line:187,column:9}},"69":{start:{line:188,column:21},end:{line:188,column:56}},"70":{start:{line:189,column:26},end:{line:201,column:11}},"71":{start:{line:202,column:10},end:{line:205,column:14}},"72":{start:{line:204,column:14},end:{line:204,column:24}},"73":{start:{line:206,column:10},end:{line:210,column:12}},"74":{start:{line:209,column:12},end:{line:209,column:22}},"75":{start:{line:211,column:10},end:{line:211,column:35}},"76":{start:{line:212,column:10},end:{line:212,column:123}},"77":{start:{line:214,column:6},end:{line:214,column:22}},"78":{start:{line:218,column:4},end:{line:283,column:5}},"79":{start:{line:219,column:27},end:{line:219,column:31}},"80":{start:{line:220,column:21},end:{line:220,column:43}},"81":{start:{line:221,column:19},end:{line:225,column:8}},"82":{start:{line:224,column:8},end:{line:224,column:18}},"83":{start:{line:226,column:6},end:{line:272,column:7}},"84":{start:{line:230,column:8},end:{line:271,column:9}},"85":{start:{line:231,column:10},end:{line:231,column:95}},"86":{start:{line:233,column:35},end:{line:237,column:12}},"87":{start:{line:236,column:12},end:{line:236,column:22}},"88":{start:{line:238,column:10},end:{line:243,column:16}},"89":{start:{line:241,column:16},end:{line:241,column:35}},"90":{start:{line:242,column:16},end:{line:242,column:26}},"91":{start:{line:244,column:14},end:{line:248,column:18}},"92":{start:{line:247,column:18},end:{line:247,column:28}},"93":{start:{line:250,column:23},end:{line:255,column:12}},"94":{start:{line:253,column:12},end:{line:253,column:31}},"95":{start:{line:254,column:12},end:{line:254,column:22}},"96":{start:{line:256,column:25},end:{line:256,column:39}},"97":{start:{line:257,column:27},end:{line:263,column:17}},"98":{start:{line:264,column:22},end:{line:264,column:47}},"99":{start:{line:265,column:10},end:{line:265,column:32}},"100":{start:{line:266,column:10},end:{line:269,column:12}},"101":{start:{line:268,column:12},end:{line:268,column:22}},"102":{start:{line:270,column:10},end:{line:270,column:37}},"103":{start:{line:274,column:6},end:{line:274,column:22}},"104":{start:{line:275,column:6},end:{line:282,column:7}},"105":{start:{line:276,column:10},end:{line:276,column:85}},"106":{start:{line:278,column:11},end:{line:282,column:7}},"107":{start:{line:279,column:10},end:{line:279,column:93}},"108":{start:{line:281,column:10},end:{line:281,column:73}},"109":{start:{line:287,column:4},end:{line:315,column:5}},"110":{start:{line:288,column:17},end:{line:288,column:30}},"111":{start:{line:289,column:6},end:{line:293,column:11}},"112":{start:{line:292,column:10},end:{line:292,column:20}},"113":{start:{line:294,column:8},end:{line:302,column:9}},"114":{start:{line:295,column:10},end:{line:301,column:11}},"115":{start:{line:296,column:12},end:{line:300,column:17}},"116":{start:{line:299,column:16},end:{line:299,column:26}},"117":{start:{line:303,column:8},end:{line:311,column:7}},"118":{start:{line:304,column:10},end:{line:310,column:11}},"119":{start:{line:305,column:12},end:{line:309,column:17}},"120":{start:{line:308,column:16},end:{line:308,column:26}},"121":{start:{line:312,column:6},end:{line:312,column:74}},"122":{start:{line:314,column:6},end:{line:314,column:23}},"123":{start:{line:320,column:4},end:{line:334,column:5}},"124":{start:{line:321,column:6},end:{line:325,column:10}},"125":{start:{line:324,column:10},end:{line:324,column:20}},"126":{start:{line:326,column:6},end:{line:329,column:10}},"127":{start:{line:328,column:10},end:{line:328,column:20}},"128":{start:{line:330,column:6},end:{line:330,column:20}},"129":{start:{line:331,column:6},end:{line:331,column:88}},"130":{start:{line:333,column:6},end:{line:333,column:23}},"131":{start:{line:340,column:4},end:{line:350,column:5}},"132":{start:{line:341,column:6},end:{line:344,column:10}},"133":{start:{line:343,column:10},end:{line:343,column:20}},"134":{start:{line:345,column:6},end:{line:345,column:50}},"135":{start:{line:346,column:6},end:{line:346,column:109}},"136":{start:{line:348,column:6},end:{line:348,column:23}},"137":{start:{line:349,column:6},end:{line:349,column:85}},"138":{start:{line:355,column:4},end:{line:401,column:5}},"139":{start:{line:356,column:17},end:{line:356,column:42}},"140":{start:{line:357,column:19},end:{line:361,column:10}},"141":{start:{line:360,column:10},end:{line:360,column:20}},"142":{start:{line:362,column:6},end:{line:398,column:7}},"143":{start:{line:363,column:8},end:{line:363,column:73}},"144":{start:{line:366,column:8},end:{line:396,column:9}},"145":{start:{line:367,column:10},end:{line:367,column:118}},"146":{start:{line:368,column:14},end:{line:396,column:9}},"147":{start:{line:369,column:10},end:{line:369,column:138}},"148":{start:{line:371,column:30},end:{line:375,column:12}},"149":{start:{line:374,column:12},end:{line:374,column:22}},"150":{start:{line:376,column:8},end:{line:395,column:9}},"151":{start:{line:377,column:10},end:{line:391,column:11}},"152":{start:{line:378,column:12},end:{line:378,column:50}},"153":{start:{line:381,column:27},end:{line:381,column:41}},"154":{start:{line:382,column:23},end:{line:388,column:13}},"155":{start:{line:389,column:12},end:{line:389,column:40}},"156":{start:{line:390,column:12},end:{line:390,column:39}},"157":{start:{line:394,column:10},end:{line:394,column:75}},"158":{start:{line:400,column:6},end:{line:400,column:23}},"159":{start:{line:406,column:4},end:{line:454,column:5}},"160":{start:{line:407,column:6},end:{line:407,column:39}},"161":{start:{line:408,column:19},end:{line:412,column:10}},"162":{start:{line:411,column:10},end:{line:411,column:20}},"163":{start:{line:413,column:6},end:{line:451,column:7}},"164":{start:{line:414,column:8},end:{line:414,column:73}},"165":{start:{line:417,column:28},end:{line:421,column:12}},"166":{start:{line:420,column:12},end:{line:420,column:22}},"167":{start:{line:422,column:8},end:{line:450,column:9}},"168":{start:{line:423,column:10},end:{line:446,column:12}},"169":{start:{line:424,column:37},end:{line:428,column:16}},"170":{start:{line:427,column:16},end:{line:427,column:26}},"171":{start:{line:429,column:12},end:{line:433,column:16}},"172":{start:{line:432,column:16},end:{line:432,column:26}},"173":{start:{line:434,column:27},end:{line:434,column:41}},"174":{start:{line:435,column:12},end:{line:441,column:14}},"175":{start:{line:442,column:12},end:{line:442,column:40}},"176":{start:{line:443,column:12},end:{line:443,column:39}},"177":{start:{line:445,column:12},end:{line:445,column:28}},"178":{start:{line:449,column:10},end:{line:449,column:75}},"179":{start:{line:459,column:4},end:{line:482,column:5}},"180":{start:{line:460,column:6},end:{line:464,column:10}},"181":{start:{line:463,column:10},end:{line:463,column:20}},"182":{start:{line:465,column:6},end:{line:465,column:45}},"183":{start:{line:466,column:6},end:{line:476,column:7}},"184":{start:{line:477,column:6},end:{line:477,column:58}},"185":{start:{line:478,column:6},end:{line:478,column:47}},"186":{start:{line:480,column:6},end:{line:480,column:23}},"187":{start:{line:481,column:6},end:{line:481,column:62}},"188":{start:{line:486,column:4},end:{line:498,column:5}},"189":{start:{line:487,column:6},end:{line:487,column:51}},"190":{start:{line:488,column:6},end:{line:491,column:11}},"191":{start:{line:490,column:10},end:{line:490,column:20}},"192":{start:{line:492,column:17},end:{line:492,column:96}},"193":{start:{line:493,column:6},end:{line:493,column:34}},"194":{start:{line:494,column:6},end:{line:494,column:35}},"195":{start:{line:497,column:6},end:{line:497,column:23}},"196":{start:{line:502,column:4},end:{line:532,column:5}},"197":{start:{line:503,column:6},end:{line:503,column:39}},"198":{start:{line:504,column:19},end:{line:508,column:10}},"199":{start:{line:507,column:10},end:{line:507,column:20}},"200":{start:{line:509,column:26},end:{line:513,column:10}},"201":{start:{line:512,column:10},end:{line:512,column:20}},"202":{start:{line:514,column:6},end:{line:529,column:7}},"203":{start:{line:515,column:35},end:{line:519,column:14}},"204":{start:{line:518,column:14},end:{line:518,column:24}},"205":{start:{line:520,column:8},end:{line:524,column:14}},"206":{start:{line:523,column:14},end:{line:523,column:24}},"207":{start:{line:525,column:8},end:{line:525,column:62}},"208":{start:{line:528,column:8},end:{line:528,column:64}},"209":{start:{line:531,column:6},end:{line:531,column:23}},"210":{start:{line:536,column:4},end:{line:589,column:5}},"211":{start:{line:537,column:19},end:{line:541,column:10}},"212":{start:{line:540,column:10},end:{line:540,column:20}},"213":{start:{line:542,column:6},end:{line:585,column:7}},"214":{start:{line:543,column:8},end:{line:543,column:163}},"215":{start:{line:544,column:12},end:{line:585,column:7}},"216":{start:{line:545,column:8},end:{line:545,column:108}},"217":{start:{line:547,column:8},end:{line:584,column:9}},"218":{start:{line:548,column:10},end:{line:548,column:129}},"219":{start:{line:550,column:26},end:{line:553,column:11}},"220":{start:{line:554,column:23},end:{line:554,column:55}},"221":{start:{line:555,column:28},end:{line:567,column:13}},"222":{start:{line:568,column:12},end:{line:571,column:16}},"223":{start:{line:570,column:16},end:{line:570,column:26}},"224":{start:{line:572,column:12},end:{line:576,column:16}},"225":{start:{line:575,column:16},end:{line:575,column:26}},"226":{start:{line:577,column:14},end:{line:581,column:16}},"227":{start:{line:580,column:16},end:{line:580,column:26}},"228":{start:{line:582,column:10},end:{line:582,column:35}},"229":{start:{line:583,column:10},end:{line:583,column:165}},"230":{start:{line:588,column:6},end:{line:588,column:22}},"231":{start:{line:593,column:4},end:{line:630,column:5}},"232":{start:{line:594,column:6},end:{line:598,column:8}},"233":{start:{line:597,column:8},end:{line:597,column:18}},"234":{start:{line:599,column:26},end:{line:602,column:11}},"235":{start:{line:603,column:23},end:{line:603,column:55}},"236":{start:{line:604,column:28},end:{line:616,column:13}},"237":{start:{line:617,column:31},end:{line:620,column:16}},"238":{start:{line:619,column:16},end:{line:619,column:26}},"239":{start:{line:621,column:14},end:{line:625,column:16}},"240":{start:{line:624,column:16},end:{line:624,column:26}},"241":{start:{line:626,column:10},end:{line:626,column:35}},"242":{start:{line:627,column:10},end:{line:627,column:119}},"243":{start:{line:629,column:6},end:{line:629,column:22}},"244":{start:{line:633,column:4},end:{line:698,column:5}},"245":{start:{line:634,column:27},end:{line:634,column:31}},"246":{start:{line:635,column:21},end:{line:635,column:47}},"247":{start:{line:636,column:19},end:{line:640,column:8}},"248":{start:{line:639,column:8},end:{line:639,column:18}},"249":{start:{line:641,column:6},end:{line:687,column:7}},"250":{start:{line:645,column:8},end:{line:686,column:9}},"251":{start:{line:646,column:10},end:{line:646,column:94}},"252":{start:{line:648,column:35},end:{line:652,column:12}},"253":{start:{line:651,column:12},end:{line:651,column:22}},"254":{start:{line:653,column:10},end:{line:658,column:16}},"255":{start:{line:656,column:16},end:{line:656,column:35}},"256":{start:{line:657,column:16},end:{line:657,column:26}},"257":{start:{line:659,column:14},end:{line:663,column:18}},"258":{start:{line:662,column:18},end:{line:662,column:28}},"259":{start:{line:665,column:23},end:{line:670,column:12}},"260":{start:{line:668,column:12},end:{line:668,column:31}},"261":{start:{line:669,column:12},end:{line:669,column:22}},"262":{start:{line:671,column:25},end:{line:671,column:39}},"263":{start:{line:672,column:27},end:{line:678,column:17}},"264":{start:{line:679,column:22},end:{line:679,column:47}},"265":{start:{line:680,column:10},end:{line:680,column:32}},"266":{start:{line:681,column:10},end:{line:684,column:12}},"267":{start:{line:683,column:12},end:{line:683,column:22}},"268":{start:{line:685,column:10},end:{line:685,column:37}},"269":{start:{line:689,column:6},end:{line:689,column:22}},"270":{start:{line:690,column:6},end:{line:697,column:7}},"271":{start:{line:691,column:10},end:{line:691,column:85}},"272":{start:{line:693,column:11},end:{line:697,column:7}},"273":{start:{line:694,column:10},end:{line:694,column:93}},"274":{start:{line:696,column:10},end:{line:696,column:73}}},fnMap:{"0":{name:"randomPasswordGenerator",decl:{start:{line:17,column:9},end:{line:17,column:32}},loc:{start:{line:17,column:35},end:{line:21,column:1}},line:17},"1":{name:"toJSON",decl:{start:{line:23,column:9},end:{line:23,column:15}},loc:{start:{line:23,column:22},end:{line:30,column:1}},line:23},"2":{name:"encrypt",decl:{start:{line:31,column:9},end:{line:31,column:16}},loc:{start:{line:31,column:27},end:{line:39,column:1}},line:31},"3":{name:"(anonymous_3)",decl:{start:{line:32,column:21},end:{line:32,column:22}},loc:{start:{line:32,column:42},end:{line:38,column:3}},line:32},"4":{name:"(anonymous_4)",decl:{start:{line:33,column:22},end:{line:33,column:23}},loc:{start:{line:33,column:41},end:{line:37,column:5}},line:33},"5":{name:"(anonymous_5)",decl:{start:{line:34,column:42},end:{line:34,column:43}},loc:{start:{line:34,column:61},end:{line:36,column:7}},line:34},"6":{name:"compare",decl:{start:{line:42,column:9},end:{line:42,column:16}},loc:{start:{line:42,column:34},end:{line:56,column:1}},line:42},"7":{name:"(anonymous_7)",decl:{start:{line:44,column:23},end:{line:44,column:24}},loc:{start:{line:44,column:44},end:{line:52,column:5}},line:44},"8":{name:"(anonymous_8)",decl:{start:{line:45,column:38},end:{line:45,column:39}},loc:{start:{line:45,column:57},end:{line:51,column:7}},line:45},"9":{name:"(anonymous_9)",decl:{start:{line:63,column:7},end:{line:63,column:8}},loc:{start:{line:63,column:33},end:{line:91,column:3}},line:63},"10":{name:"(anonymous_10)",decl:{start:{line:67,column:64},end:{line:67,column:65}},loc:{start:{line:67,column:71},end:{line:70,column:9}},line:67},"11":{name:"(anonymous_11)",decl:{start:{line:82,column:17},end:{line:82,column:18}},loc:{start:{line:82,column:26},end:{line:84,column:11}},line:82},"12":{name:"(anonymous_12)",decl:{start:{line:92,column:11},end:{line:92,column:12}},loc:{start:{line:92,column:37},end:{line:119,column:3}},line:92},"13":{name:"(anonymous_13)",decl:{start:{line:96,column:17},end:{line:96,column:18}},loc:{start:{line:96,column:24},end:{line:99,column:11}},line:96},"14":{name:"(anonymous_14)",decl:{start:{line:121,column:10},end:{line:121,column:11}},loc:{start:{line:121,column:34},end:{line:175,column:3}},line:121},"15":{name:"(anonymous_15)",decl:{start:{line:125,column:13},end:{line:125,column:14}},loc:{start:{line:125,column:22},end:{line:127,column:7}},line:125},"16":{name:"(anonymous_16)",decl:{start:{line:129,column:15},end:{line:129,column:16}},loc:{start:{line:129,column:22},end:{line:133,column:9}},line:129},"17":{name:"(anonymous_17)",decl:{start:{line:153,column:15},end:{line:153,column:16}},loc:{start:{line:153,column:22},end:{line:155,column:9}},line:153},"18":{name:"(anonymous_18)",decl:{start:{line:158,column:15},end:{line:158,column:16}},loc:{start:{line:158,column:22},end:{line:161,column:9}},line:158},"19":{name:"(anonymous_19)",decl:{start:{line:165,column:19},end:{line:165,column:20}},loc:{start:{line:165,column:26},end:{line:168,column:13}},line:165},"20":{name:"(anonymous_20)",decl:{start:{line:176,column:36},end:{line:176,column:37}},loc:{start:{line:176,column:89},end:{line:216,column:3}},line:176},"21":{name:"(anonymous_21)",decl:{start:{line:180,column:15},end:{line:180,column:16}},loc:{start:{line:180,column:22},end:{line:183,column:9}},line:180},"22":{name:"(anonymous_22)",decl:{start:{line:203,column:19},end:{line:203,column:20}},loc:{start:{line:203,column:26},end:{line:205,column:13}},line:203},"23":{name:"(anonymous_23)",decl:{start:{line:207,column:17},end:{line:207,column:18}},loc:{start:{line:207,column:24},end:{line:210,column:11}},line:207},"24":{name:"(anonymous_24)",decl:{start:{line:217,column:20},end:{line:217,column:21}},loc:{start:{line:217,column:44},end:{line:284,column:3}},line:217},"25":{name:"(anonymous_25)",decl:{start:{line:222,column:13},end:{line:222,column:14}},loc:{start:{line:222,column:20},end:{line:225,column:7}},line:222},"26":{name:"(anonymous_26)",decl:{start:{line:234,column:17},end:{line:234,column:18}},loc:{start:{line:234,column:24},end:{line:237,column:11}},line:234},"27":{name:"(anonymous_27)",decl:{start:{line:239,column:21},end:{line:239,column:22}},loc:{start:{line:239,column:28},end:{line:243,column:15}},line:239},"28":{name:"(anonymous_28)",decl:{start:{line:245,column:23},end:{line:245,column:24}},loc:{start:{line:245,column:30},end:{line:248,column:17}},line:245},"29":{name:"(anonymous_29)",decl:{start:{line:251,column:17},end:{line:251,column:18}},loc:{start:{line:251,column:24},end:{line:255,column:11}},line:251},"30":{name:"(anonymous_30)",decl:{start:{line:267,column:17},end:{line:267,column:18}},loc:{start:{line:267,column:24},end:{line:269,column:11}},line:267},"31":{name:"(anonymous_31)",decl:{start:{line:286,column:10},end:{line:286,column:11}},loc:{start:{line:286,column:36},end:{line:316,column:3}},line:286},"32":{name:"(anonymous_32)",decl:{start:{line:290,column:15},end:{line:290,column:16}},loc:{start:{line:290,column:22},end:{line:293,column:9}},line:290},"33":{name:"(anonymous_33)",decl:{start:{line:297,column:21},end:{line:297,column:22}},loc:{start:{line:297,column:28},end:{line:300,column:15}},line:297},"34":{name:"(anonymous_34)",decl:{start:{line:306,column:21},end:{line:306,column:22}},loc:{start:{line:306,column:28},end:{line:309,column:15}},line:306},"35":{name:"(anonymous_35)",decl:{start:{line:318,column:10},end:{line:318,column:11}},loc:{start:{line:318,column:36},end:{line:335,column:3}},line:318},"36":{name:"(anonymous_36)",decl:{start:{line:322,column:15},end:{line:322,column:16}},loc:{start:{line:322,column:22},end:{line:325,column:9}},line:322},"37":{name:"(anonymous_37)",decl:{start:{line:327,column:15},end:{line:327,column:16}},loc:{start:{line:327,column:24},end:{line:329,column:9}},line:327},"38":{name:"(anonymous_38)",decl:{start:{line:338,column:20},end:{line:338,column:21}},loc:{start:{line:338,column:46},end:{line:351,column:3}},line:338},"39":{name:"(anonymous_39)",decl:{start:{line:342,column:15},end:{line:342,column:16}},loc:{start:{line:342,column:24},end:{line:344,column:9}},line:342},"40":{name:"(anonymous_40)",decl:{start:{line:354,column:13},end:{line:354,column:14}},loc:{start:{line:354,column:37},end:{line:402,column:3}},line:354},"41":{name:"(anonymous_41)",decl:{start:{line:358,column:15},end:{line:358,column:16}},loc:{start:{line:358,column:22},end:{line:361,column:9}},line:358},"42":{name:"(anonymous_42)",decl:{start:{line:372,column:17},end:{line:372,column:18}},loc:{start:{line:372,column:24},end:{line:375,column:11}},line:372},"43":{name:"(anonymous_43)",decl:{start:{line:404,column:18},end:{line:404,column:19}},loc:{start:{line:404,column:42},end:{line:455,column:3}},line:404},"44":{name:"(anonymous_44)",decl:{start:{line:409,column:15},end:{line:409,column:16}},loc:{start:{line:409,column:22},end:{line:412,column:9}},line:409},"45":{name:"(anonymous_45)",decl:{start:{line:418,column:17},end:{line:418,column:18}},loc:{start:{line:418,column:24},end:{line:421,column:11}},line:418},"46":{name:"(anonymous_46)",decl:{start:{line:423,column:74},end:{line:423,column:75}},loc:{start:{line:423,column:91},end:{line:444,column:11}},line:423},"47":{name:"(anonymous_47)",decl:{start:{line:425,column:21},end:{line:425,column:22}},loc:{start:{line:425,column:28},end:{line:428,column:15}},line:425},"48":{name:"(anonymous_48)",decl:{start:{line:430,column:21},end:{line:430,column:22}},loc:{start:{line:430,column:28},end:{line:433,column:15}},line:430},"49":{name:"(anonymous_49)",decl:{start:{line:444,column:19},end:{line:444,column:20}},loc:{start:{line:444,column:26},end:{line:446,column:11}},line:444},"50":{name:"(anonymous_50)",decl:{start:{line:457,column:15},end:{line:457,column:16}},loc:{start:{line:457,column:38},end:{line:483,column:3}},line:457},"51":{name:"(anonymous_51)",decl:{start:{line:461,column:15},end:{line:461,column:16}},loc:{start:{line:461,column:22},end:{line:464,column:9}},line:461},"52":{name:"(anonymous_52)",decl:{start:{line:484,column:18},end:{line:484,column:19}},loc:{start:{line:484,column:42},end:{line:499,column:3}},line:484},"53":{name:"(anonymous_53)",decl:{start:{line:489,column:15},end:{line:489,column:16}},loc:{start:{line:489,column:22},end:{line:491,column:9}},line:489},"54":{name:"(anonymous_54)",decl:{start:{line:500,column:27},end:{line:500,column:28}},loc:{start:{line:500,column:51},end:{line:533,column:3}},line:500},"55":{name:"(anonymous_55)",decl:{start:{line:505,column:15},end:{line:505,column:16}},loc:{start:{line:505,column:22},end:{line:508,column:9}},line:505},"56":{name:"(anonymous_56)",decl:{start:{line:510,column:15},end:{line:510,column:16}},loc:{start:{line:510,column:22},end:{line:513,column:9}},line:510},"57":{name:"(anonymous_57)",decl:{start:{line:516,column:19},end:{line:516,column:20}},loc:{start:{line:516,column:26},end:{line:519,column:13}},line:516},"58":{name:"(anonymous_58)",decl:{start:{line:521,column:19},end:{line:521,column:20}},loc:{start:{line:521,column:26},end:{line:524,column:13}},line:521},"59":{name:"(anonymous_59)",decl:{start:{line:534,column:26},end:{line:534,column:27}},loc:{start:{line:534,column:50},end:{line:590,column:3}},line:534},"60":{name:"(anonymous_60)",decl:{start:{line:538,column:15},end:{line:538,column:16}},loc:{start:{line:538,column:22},end:{line:541,column:9}},line:538},"61":{name:"(anonymous_61)",decl:{start:{line:569,column:21},end:{line:569,column:22}},loc:{start:{line:569,column:28},end:{line:571,column:15}},line:569},"62":{name:"(anonymous_62)",decl:{start:{line:573,column:21},end:{line:573,column:22}},loc:{start:{line:573,column:28},end:{line:576,column:15}},line:573},"63":{name:"(anonymous_63)",decl:{start:{line:578,column:21},end:{line:578,column:22}},loc:{start:{line:578,column:28},end:{line:581,column:15}},line:578},"64":{name:"(anonymous_64)",decl:{start:{line:591,column:34},end:{line:591,column:35}},loc:{start:{line:591,column:87},end:{line:631,column:3}},line:591},"65":{name:"(anonymous_65)",decl:{start:{line:595,column:13},end:{line:595,column:14}},loc:{start:{line:595,column:20},end:{line:598,column:7}},line:595},"66":{name:"(anonymous_66)",decl:{start:{line:618,column:21},end:{line:618,column:22}},loc:{start:{line:618,column:28},end:{line:620,column:15}},line:618},"67":{name:"(anonymous_67)",decl:{start:{line:622,column:21},end:{line:622,column:22}},loc:{start:{line:622,column:28},end:{line:625,column:15}},line:622},"68":{name:"(anonymous_68)",decl:{start:{line:632,column:18},end:{line:632,column:19}},loc:{start:{line:632,column:42},end:{line:699,column:3}},line:632},"69":{name:"(anonymous_69)",decl:{start:{line:637,column:13},end:{line:637,column:14}},loc:{start:{line:637,column:20},end:{line:640,column:7}},line:637},"70":{name:"(anonymous_70)",decl:{start:{line:649,column:17},end:{line:649,column:18}},loc:{start:{line:649,column:24},end:{line:652,column:11}},line:649},"71":{name:"(anonymous_71)",decl:{start:{line:654,column:21},end:{line:654,column:22}},loc:{start:{line:654,column:28},end:{line:658,column:15}},line:654},"72":{name:"(anonymous_72)",decl:{start:{line:660,column:23},end:{line:660,column:24}},loc:{start:{line:660,column:30},end:{line:663,column:17}},line:660},"73":{name:"(anonymous_73)",decl:{start:{line:666,column:17},end:{line:666,column:18}},loc:{start:{line:666,column:24},end:{line:670,column:11}},line:666},"74":{name:"(anonymous_74)",decl:{start:{line:682,column:17},end:{line:682,column:18}},loc:{start:{line:682,column:24},end:{line:684,column:11}},line:682}},branchMap:{"0":{loc:{start:{line:46,column:8},end:{line:50,column:9}},type:"if",locations:[{start:{line:46,column:8},end:{line:50,column:9}},{start:{line:46,column:8},end:{line:50,column:9}}],line:46},"1":{loc:{start:{line:66,column:6},end:{line:85,column:7}},type:"if",locations:[{start:{line:66,column:6},end:{line:85,column:7}},{start:{line:66,column:6},end:{line:85,column:7}}],line:66},"2":{loc:{start:{line:80,column:12},end:{line:85,column:7}},type:"if",locations:[{start:{line:80,column:12},end:{line:85,column:7}},{start:{line:80,column:12},end:{line:85,column:7}}],line:80},"3":{loc:{start:{line:162,column:6},end:{line:170,column:7}},type:"if",locations:[{start:{line:162,column:6},end:{line:170,column:7}},{start:{line:162,column:6},end:{line:170,column:7}}],line:162},"4":{loc:{start:{line:226,column:6},end:{line:272,column:7}},type:"if",locations:[{start:{line:226,column:6},end:{line:272,column:7}},{start:{line:226,column:6},end:{line:272,column:7}}],line:226},"5":{loc:{start:{line:230,column:8},end:{line:271,column:9}},type:"if",locations:[{start:{line:230,column:8},end:{line:271,column:9}},{start:{line:230,column:8},end:{line:271,column:9}}],line:230},"6":{loc:{start:{line:275,column:6},end:{line:282,column:7}},type:"if",locations:[{start:{line:275,column:6},end:{line:282,column:7}},{start:{line:275,column:6},end:{line:282,column:7}}],line:275},"7":{loc:{start:{line:278,column:11},end:{line:282,column:7}},type:"if",locations:[{start:{line:278,column:11},end:{line:282,column:7}},{start:{line:278,column:11},end:{line:282,column:7}}],line:278},"8":{loc:{start:{line:294,column:8},end:{line:302,column:9}},type:"if",locations:[{start:{line:294,column:8},end:{line:302,column:9}},{start:{line:294,column:8},end:{line:302,column:9}}],line:294},"9":{loc:{start:{line:303,column:8},end:{line:311,column:7}},type:"if",locations:[{start:{line:303,column:8},end:{line:311,column:7}},{start:{line:303,column:8},end:{line:311,column:7}}],line:303},"10":{loc:{start:{line:362,column:6},end:{line:398,column:7}},type:"if",locations:[{start:{line:362,column:6},end:{line:398,column:7}},{start:{line:362,column:6},end:{line:398,column:7}}],line:362},"11":{loc:{start:{line:366,column:8},end:{line:396,column:9}},type:"if",locations:[{start:{line:366,column:8},end:{line:396,column:9}},{start:{line:366,column:8},end:{line:396,column:9}}],line:366},"12":{loc:{start:{line:368,column:14},end:{line:396,column:9}},type:"if",locations:[{start:{line:368,column:14},end:{line:396,column:9}},{start:{line:368,column:14},end:{line:396,column:9}}],line:368},"13":{loc:{start:{line:376,column:8},end:{line:395,column:9}},type:"if",locations:[{start:{line:376,column:8},end:{line:395,column:9}},{start:{line:376,column:8},end:{line:395,column:9}}],line:376},"14":{loc:{start:{line:377,column:10},end:{line:391,column:11}},type:"if",locations:[{start:{line:377,column:10},end:{line:391,column:11}},{start:{line:377,column:10},end:{line:391,column:11}}],line:377},"15":{loc:{start:{line:413,column:6},end:{line:451,column:7}},type:"if",locations:[{start:{line:413,column:6},end:{line:451,column:7}},{start:{line:413,column:6},end:{line:451,column:7}}],line:413},"16":{loc:{start:{line:422,column:8},end:{line:450,column:9}},type:"if",locations:[{start:{line:422,column:8},end:{line:450,column:9}},{start:{line:422,column:8},end:{line:450,column:9}}],line:422},"17":{loc:{start:{line:514,column:6},end:{line:529,column:7}},type:"if",locations:[{start:{line:514,column:6},end:{line:529,column:7}},{start:{line:514,column:6},end:{line:529,column:7}}],line:514},"18":{loc:{start:{line:542,column:6},end:{line:585,column:7}},type:"if",locations:[{start:{line:542,column:6},end:{line:585,column:7}},{start:{line:542,column:6},end:{line:585,column:7}}],line:542},"19":{loc:{start:{line:544,column:12},end:{line:585,column:7}},type:"if",locations:[{start:{line:544,column:12},end:{line:585,column:7}},{start:{line:544,column:12},end:{line:585,column:7}}],line:544},"20":{loc:{start:{line:547,column:8},end:{line:584,column:9}},type:"if",locations:[{start:{line:547,column:8},end:{line:584,column:9}},{start:{line:547,column:8},end:{line:584,column:9}}],line:547},"21":{loc:{start:{line:641,column:6},end:{line:687,column:7}},type:"if",locations:[{start:{line:641,column:6},end:{line:687,column:7}},{start:{line:641,column:6},end:{line:687,column:7}}],line:641},"22":{loc:{start:{line:645,column:8},end:{line:686,column:9}},type:"if",locations:[{start:{line:645,column:8},end:{line:686,column:9}},{start:{line:645,column:8},end:{line:686,column:9}}],line:645},"23":{loc:{start:{line:690,column:6},end:{line:697,column:7}},type:"if",locations:[{start:{line:690,column:6},end:{line:697,column:7}},{start:{line:690,column:6},end:{line:697,column:7}}],line:690},"24":{loc:{start:{line:693,column:11},end:{line:697,column:7}},type:"if",locations:[{start:{line:693,column:11},end:{line:697,column:7}},{start:{line:693,column:11},end:{line:697,column:7}}],line:693}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0,"86":0,"87":0,"88":0,"89":0,"90":0,"91":0,"92":0,"93":0,"94":0,"95":0,"96":0,"97":0,"98":0,"99":0,"100":0,"101":0,"102":0,"103":0,"104":0,"105":0,"106":0,"107":0,"108":0,"109":0,"110":0,"111":0,"112":0,"113":0,"114":0,"115":0,"116":0,"117":0,"118":0,"119":0,"120":0,"121":0,"122":0,"123":0,"124":0,"125":0,"126":0,"127":0,"128":0,"129":0,"130":0,"131":0,"132":0,"133":0,"134":0,"135":0,"136":0,"137":0,"138":0,"139":0,"140":0,"141":0,"142":0,"143":0,"144":0,"145":0,"146":0,"147":0,"148":0,"149":0,"150":0,"151":0,"152":0,"153":0,"154":0,"155":0,"156":0,"157":0,"158":0,"159":0,"160":0,"161":0,"162":0,"163":0,"164":0,"165":0,"166":0,"167":0,"168":0,"169":0,"170":0,"171":0,"172":0,"173":0,"174":0,"175":0,"176":0,"177":0,"178":0,"179":0,"180":0,"181":0,"182":0,"183":0,"184":0,"185":0,"186":0,"187":0,"188":0,"189":0,"190":0,"191":0,"192":0,"193":0,"194":0,"195":0,"196":0,"197":0,"198":0,"199":0,"200":0,"201":0,"202":0,"203":0,"204":0,"205":0,"206":0,"207":0,"208":0,"209":0,"210":0,"211":0,"212":0,"213":0,"214":0,"215":0,"216":0,"217":0,"218":0,"219":0,"220":0,"221":0,"222":0,"223":0,"224":0,"225":0,"226":0,"227":0,"228":0,"229":0,"230":0,"231":0,"232":0,"233":0,"234":0,"235":0,"236":0,"237":0,"238":0,"239":0,"240":0,"241":0,"242":0,"243":0,"244":0,"245":0,"246":0,"247":0,"248":0,"249":0,"250":0,"251":0,"252":0,"253":0,"254":0,"255":0,"256":0,"257":0,"258":0,"259":0,"260":0,"261":0,"262":0,"263":0,"264":0,"265":0,"266":0,"267":0,"268":0,"269":0,"270":0,"271":0,"272":0,"273":0,"274":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0],"20":[0,0],"21":[0,0],"22":[0,0],"23":[0,0],"24":[0,0]},_coverageSchema:"43e27e138ebf9cfc5966b082cf9a028302ed4184"},coverage=global[gcv]||(global[gcv]={});if(coverage[path]&&coverage[path].hash===hash){return coverage[path];}coverageData.hash=hash;return coverage[path]=coverageData;}();const email=(cov_56x3pjfvl.s[0]++,require("../services/email"));const Math=(cov_56x3pjfvl.s[1]++,require("mathjs"));const db=(cov_56x3pjfvl.s[2]++,require("../db"));const jwt=(cov_56x3pjfvl.s[3]++,require("../services/jwt"));const bcrypt=(cov_56x3pjfvl.s[4]++,require("bcrypt-nodejs"));const UpdatePasswordPolicy=(cov_56x3pjfvl.s[5]++,require("../policies/UpdatePasswordPolicy"));const user_db=(cov_56x3pjfvl.s[6]++,require('../services/database/users_db'));const devices_db=(cov_56x3pjfvl.s[7]++,require("../services/database/devices_db"));const USER_VESSEL_DB=(cov_56x3pjfvl.s[8]++,require("../services/database/user_vessel_db"));const db_user_reset_password_token=(cov_56x3pjfvl.s[9]++,require("../services/database/user_reset_password_token_db"));const db_activate_user_account_token=(cov_56x3pjfvl.s[10]++,require("../services/database/activate_user_account_token_db"));//Creates a random password of length 8 using characters 0-9 and
function randomPasswordGenerator(){cov_56x3pjfvl.f[0]++;cov_56x3pjfvl.s[11]++;return Math.random(0,2).toString(36).substring(2,10);}function toJSON(user){cov_56x3pjfvl.f[1]++;cov_56x3pjfvl.s[12]++;//this converts the user data returned from the database query to a json object
return{id:user[0].id,email:user[0].email,user_class:user[0].user_class};}function encrypt(password){cov_56x3pjfvl.f[2]++;cov_56x3pjfvl.s[13]++;return new Promise((resolve,reject)=>{cov_56x3pjfvl.f[3]++;cov_56x3pjfvl.s[14]++;bcrypt.genSalt(5,(error,result)=>{cov_56x3pjfvl.f[4]++;cov_56x3pjfvl.s[15]++;bcrypt.hash(password,result,null,(error,result)=>{cov_56x3pjfvl.f[5]++;cov_56x3pjfvl.s[16]++;resolve(result);});});});}//Function compares the plain text password and the encryted password stored in the 
//database and returns 1 if they are the same and 0 if they are different 
function compare(data,encrypted){cov_56x3pjfvl.f[6]++;cov_56x3pjfvl.s[17]++;try{cov_56x3pjfvl.s[18]++;return new Promise((resolve,reject)=>{cov_56x3pjfvl.f[7]++;cov_56x3pjfvl.s[19]++;bcrypt.compare(data,encrypted,(error,result)=>{cov_56x3pjfvl.f[8]++;cov_56x3pjfvl.s[20]++;if(result==true){cov_56x3pjfvl.b[0][0]++;cov_56x3pjfvl.s[21]++;return resolve(1);}else{cov_56x3pjfvl.b[0][1]++;cov_56x3pjfvl.s[22]++;return resolve(0);}});});}catch(err){cov_56x3pjfvl.s[23]++;throw err;}}//---------------------------------------------------------------------------------------------------------------------------------------------------------------------
//---------------------------------------------------------------------------------------------------------------------------------------------------------------------
cov_56x3pjfvl.s[24]++;module.exports={//Get Users
get:async function(req,res){cov_56x3pjfvl.f[9]++;let users;cov_56x3pjfvl.s[25]++;try{cov_56x3pjfvl.s[26]++;if(req.access=='self'){cov_56x3pjfvl.b[1][0]++;cov_56x3pjfvl.s[27]++;users=await user_db.get_profile(req.user.email).catch(err=>{cov_56x3pjfvl.f[10]++;cov_56x3pjfvl.s[28]++;//Error fetching user profile information from database
throw err;});cov_56x3pjfvl.s[29]++;users=users[0];cov_56x3pjfvl.s[30]++;users={first_name:users.first_name,last_name:users.last_name,address:users.address,home_phone:users.home_phone,mobile_phone:users.mobile_phone,email:users.email};}else{cov_56x3pjfvl.b[1][1]++;cov_56x3pjfvl.s[31]++;if(req.access=='all'){cov_56x3pjfvl.b[2][0]++;cov_56x3pjfvl.s[32]++;users=await user_db.get_users().catch(err=>{cov_56x3pjfvl.f[11]++;cov_56x3pjfvl.s[33]++;throw err;});}else{cov_56x3pjfvl.b[2][1]++;}}cov_56x3pjfvl.s[34]++;users=JSON.stringify(users);cov_56x3pjfvl.s[35]++;res.status(200).send({users:users,message:'Users fetched',type:'success'});}catch(err){cov_56x3pjfvl.s[36]++;res.status(500).send({message:"Failed to get users",type:'error'});}},get_one:async function(req,res){cov_56x3pjfvl.f[12]++;let users;cov_56x3pjfvl.s[37]++;try{cov_56x3pjfvl.s[38]++;users=await user_db.get_user(req.params.user_id).catch(err=>{cov_56x3pjfvl.f[13]++;cov_56x3pjfvl.s[39]++;//Error fetching user account information from database
throw err;});cov_56x3pjfvl.s[40]++;users=users[0];cov_56x3pjfvl.s[41]++;users={user_id:users.id,first_name:users.first_name,last_name:users.last_name,user_country:users.user_country,user_city:users.user_city,user_district:users.user_district,user_street:users.user_street,home_phone:users.home_phone,mobile_phone:users.mobile_phone,user_class:users.user_class,email:users.email};cov_56x3pjfvl.s[42]++;res.status(200).send({users:users,message:'Users fetched',type:'success'});}catch(err){cov_56x3pjfvl.s[43]++;console.log(err);cov_56x3pjfvl.s[44]++;res.status(500).send({message:"Failed to get users",type:'error'});}},//Add User
create:async function(req,res){cov_56x3pjfvl.f[14]++;cov_56x3pjfvl.s[45]++;try{let data=(cov_56x3pjfvl.s[46]++,req.body.user);cov_56x3pjfvl.s[47]++;await user_db.add_user(data,'null').catch(err=>{cov_56x3pjfvl.f[15]++;cov_56x3pjfvl.s[48]++;throw err;});let user=(cov_56x3pjfvl.s[49]++,await user_db.get_profile(data.email).catch(err=>{cov_56x3pjfvl.f[16]++;cov_56x3pjfvl.s[50]++;//Error fetching the user account information of the previously created account
//We do this to get the id of the associated account.
throw err;}));let user_JSON=(cov_56x3pjfvl.s[51]++,{email:`${data.email}`,user_id:`${user[0].id}`});let token=(cov_56x3pjfvl.s[52]++,jwt.jwt_activate_account(user_JSON));var mailOptions=(cov_56x3pjfvl.s[53]++,{from:'lorawanconsole@gmail.com',to:data.email,subject:'Activate Account',html:`<h2>Good Day ${data.first_name},</h2> 
        <p>An account has been created using your email address for the Private Marine IoT Network Web Based Console.<br> 
        You have been granted ${data.user_class} privilages. Click <b><a href="http://localhost:8081/#/user/activate/${token}">here</a></b> to activate your account and create a password.<br>
        <b>This link is only valid for the next 48 hours.</b>
        </p>
        
        Thank You,<br>
        The Private Marine IoT Network Web Based Console Team`});cov_56x3pjfvl.s[54]++;await email.transporter.sendMail(mailOptions).catch(err=>{cov_56x3pjfvl.f[17]++;cov_56x3pjfvl.s[55]++;throw err;});cov_56x3pjfvl.s[56]++;console.log('email sent');cov_56x3pjfvl.s[57]++;await db_activate_user_account_token.create_activate_user_account_token(token,user[0].id).catch(err=>{cov_56x3pjfvl.f[18]++;cov_56x3pjfvl.s[58]++;//Error creating token in black list
throw err;});cov_56x3pjfvl.s[59]++;if(data.vessels.length>0){cov_56x3pjfvl.b[3][0]++;cov_56x3pjfvl.s[60]++;for(let i=0;i<data.vessels.length;i++){cov_56x3pjfvl.s[61]++;await USER_VESSEL_DB.create_user_vessel_relationship(user[0].id,data.vessels[i]).catch(err=>{cov_56x3pjfvl.f[19]++;cov_56x3pjfvl.s[62]++;//Error adding a user device eui to the database
throw err;});}}else{cov_56x3pjfvl.b[3][1]++;};cov_56x3pjfvl.s[63]++;res.status(200).send({message:'User created.',type:'success'});}catch(err){cov_56x3pjfvl.s[64]++;res.status(500).send({message:"Error creating user account",type:"error"});}},resend_activate_account_request:async function(req,res,token_old,user_information){cov_56x3pjfvl.f[20]++;cov_56x3pjfvl.s[65]++;//This resends the email to the user to activate their acount after the initial link expired
try{cov_56x3pjfvl.s[66]++;await db_activate_user_account_token.delete_activate_user_account_token(token_old).catch(err=>{cov_56x3pjfvl.f[21]++;cov_56x3pjfvl.s[67]++;//Error deleting token in black list
throw err;});let user_JSON=(cov_56x3pjfvl.s[68]++,{email:`${user_information.email}`,user_id:`${user_information.user_id}`});let token=(cov_56x3pjfvl.s[69]++,jwt.jwt_activate_account(user_JSON));var mailOptions=(cov_56x3pjfvl.s[70]++,{from:'lorawanconsole@gmail.com',to:user_information.email,subject:'Activate Account',html:`<h2>Good Day,</h2> 
          <p>An account has been created using your email address for the Private Marine IoT Network Web Based Console.<br> 
          However, the previous link expired. Please click <b><a href="http://localhost:8081/#/user/activate/${token}">here</a></b> to activate your account and create a password.<br>
          <b>This link is only valid for the next 48 hours.</b>
          </p>
          
          Thank You,<br>
          The Private Marine IoT Network Web Based Console Team`});cov_56x3pjfvl.s[71]++;await email.transporter.sendMail(mailOptions).catch(err=>{cov_56x3pjfvl.f[22]++;cov_56x3pjfvl.s[72]++;throw err;});cov_56x3pjfvl.s[73]++;await db_activate_user_account_token.create_activate_user_account_token(token,user_information.user_id).catch(err=>{cov_56x3pjfvl.f[23]++;cov_56x3pjfvl.s[74]++;//Error creating token in black list
throw err;});cov_56x3pjfvl.s[75]++;console.log('Email Sent');cov_56x3pjfvl.s[76]++;res.status(401).send({error:"Token previously expired. Please check email for new account activation link."});}catch(err){cov_56x3pjfvl.s[77]++;console.log(err);}},activate_account:async function(req,res){cov_56x3pjfvl.f[24]++;cov_56x3pjfvl.s[78]++;try{let error_location=(cov_56x3pjfvl.s[79]++,null);let password=(cov_56x3pjfvl.s[80]++,req.body.data.password);let result=(cov_56x3pjfvl.s[81]++,await user_db.get_profile(req.user.email).catch(err=>{cov_56x3pjfvl.f[25]++;cov_56x3pjfvl.s[82]++;//Error getting user form database using email to find
throw err;}));cov_56x3pjfvl.s[83]++;if(result==""){//Email does not exists 
cov_56x3pjfvl.b[4][0]++;}else{cov_56x3pjfvl.b[4][1]++;cov_56x3pjfvl.s[84]++;if(result[0].user_account_activation==1){cov_56x3pjfvl.b[5][0]++;cov_56x3pjfvl.s[85]++;//Correct email but account already activated
res.status(403).send({message:"Account already activated. This is an old link."});}else{cov_56x3pjfvl.b[5][1]++;let encrypted_password=(cov_56x3pjfvl.s[86]++,await encrypt(password).catch(err=>{cov_56x3pjfvl.f[26]++;cov_56x3pjfvl.s[87]++;//Error encrypting pw
throw err;}));cov_56x3pjfvl.s[88]++;await user_db.update_user_pw(encrypted_password,req.user.email).catch(err=>{cov_56x3pjfvl.f[27]++;cov_56x3pjfvl.s[89]++;//Error updating user pw
error_location=0;cov_56x3pjfvl.s[90]++;throw err;});cov_56x3pjfvl.s[91]++;await user_db.activate_user_account(req.user.email).catch(err=>{cov_56x3pjfvl.f[28]++;cov_56x3pjfvl.s[92]++;//Error setting user_account_activation flag
throw err;});//Password Updated.... Now we are going to login the user
let result=(cov_56x3pjfvl.s[93]++,await user_db.get_profile(req.user.email).catch(err=>{cov_56x3pjfvl.f[29]++;cov_56x3pjfvl.s[94]++;//Error getting user form database using email to find(Password updated)
error_location=1;cov_56x3pjfvl.s[95]++;throw err;}));let userJSON=(cov_56x3pjfvl.s[96]++,toJSON(result));let data=(cov_56x3pjfvl.s[97]++,{user:userJSON,user_class:result[0].user_class,token:jwt.jwtUserSignin(userJSON),message:'Successful Login',user_name:result[0].first_name+" "+result[0].last_name});let token=(cov_56x3pjfvl.s[98]++,req.headers.authorization);cov_56x3pjfvl.s[99]++;token=token.slice(7);cov_56x3pjfvl.s[100]++;await db_activate_user_account_token.delete_activate_user_account_token(token).catch(err=>{cov_56x3pjfvl.f[30]++;cov_56x3pjfvl.s[101]++;throw err;});cov_56x3pjfvl.s[102]++;res.status(200).send(data);}}}catch(err){cov_56x3pjfvl.s[103]++;console.log(err);cov_56x3pjfvl.s[104]++;if(error_location==0){cov_56x3pjfvl.b[6][0]++;cov_56x3pjfvl.s[105]++;res.status(500).send({message:"Failed update password",type:'error'});}else{cov_56x3pjfvl.b[6][1]++;cov_56x3pjfvl.s[106]++;if(error_location==1){cov_56x3pjfvl.b[7][0]++;cov_56x3pjfvl.s[107]++;res.status(200).send({message:"Password Updated. Failed to login",type:'info'});}else{cov_56x3pjfvl.b[7][1]++;cov_56x3pjfvl.s[108]++;res.status(500).send({message:'Server Error',type:'error'});}}}},//Update User
update:async function(req,res){cov_56x3pjfvl.f[31]++;cov_56x3pjfvl.s[109]++;try{let data=(cov_56x3pjfvl.s[110]++,req.body.user);cov_56x3pjfvl.s[111]++;await user_db.update_user(data,req.params.user_id).catch(err=>{cov_56x3pjfvl.f[32]++;cov_56x3pjfvl.s[112]++;//Error updating user on the database
throw err;});cov_56x3pjfvl.s[113]++;if(data.vessels.deleted.length>0){cov_56x3pjfvl.b[8][0]++;cov_56x3pjfvl.s[114]++;for(let i=0;i<data.vessels.deleted.length;i++){cov_56x3pjfvl.s[115]++;await USER_VESSEL_DB.delete_user_vessel_relationship(req.params.user_id,data.vessels.deleted[i]).catch(err=>{cov_56x3pjfvl.f[33]++;cov_56x3pjfvl.s[116]++;//Error deleting user vessel relationship
throw err;});}}else{cov_56x3pjfvl.b[8][1]++;}cov_56x3pjfvl.s[117]++;if(data.vessels.added.length>0){cov_56x3pjfvl.b[9][0]++;cov_56x3pjfvl.s[118]++;for(let i=0;i<data.vessels.added.length;i++){cov_56x3pjfvl.s[119]++;await USER_VESSEL_DB.create_user_vessel_relationship(req.params.user_id,data.vessels.added[i]).catch(err=>{cov_56x3pjfvl.f[34]++;cov_56x3pjfvl.s[120]++;//Error deleting user vessel relationship
throw err;});}}else{cov_56x3pjfvl.b[9][1]++;}cov_56x3pjfvl.s[121]++;res.status(200).send({message:'User updated.',type:'success'});}catch(err){cov_56x3pjfvl.s[122]++;console.log(err);}},//Delete User
delete:async function(req,res){cov_56x3pjfvl.f[35]++;let users;cov_56x3pjfvl.s[123]++;try{cov_56x3pjfvl.s[124]++;await user_db.delete_user(req.params.id).catch(err=>{cov_56x3pjfvl.f[36]++;cov_56x3pjfvl.s[125]++;//Error deleting user
throw err;});cov_56x3pjfvl.s[126]++;users=await user_db.get_users().catch(err=>{cov_56x3pjfvl.f[37]++;cov_56x3pjfvl.s[127]++;throw err;});cov_56x3pjfvl.s[128]++;users=users;cov_56x3pjfvl.s[129]++;res.status(200).send({users:users,message:'User deleted.',type:'success'});}catch(err){cov_56x3pjfvl.s[130]++;console.log(err);}},//Get User Vessels (devices associated with a fisher)
get_user_vessels:async function(req,res){cov_56x3pjfvl.f[38]++;let user_vessels;cov_56x3pjfvl.s[131]++;try{cov_56x3pjfvl.s[132]++;user_vessels=await USER_VESSEL_DB.get_user_vessels_not_deleted(req.params.user_id).catch(err=>{cov_56x3pjfvl.f[39]++;cov_56x3pjfvl.s[133]++;throw err;});cov_56x3pjfvl.s[134]++;user_vessels=JSON.stringify(user_vessels);cov_56x3pjfvl.s[135]++;res.status(200).send({user_vessels:user_vessels,message:'User vessels fetched',type:'success'});}catch(err){cov_56x3pjfvl.s[136]++;console.log(err);cov_56x3pjfvl.s[137]++;res.status(500).send({message:"Failed to get user vessels",type:'error'});}},//Login New
login_new:async function(req,res){cov_56x3pjfvl.f[40]++;cov_56x3pjfvl.s[138]++;try{let data=(cov_56x3pjfvl.s[139]++,JSON.parse(req.body.data));let result=(cov_56x3pjfvl.s[140]++,await user_db.get_profile(data.email).catch(err=>{cov_56x3pjfvl.f[41]++;cov_56x3pjfvl.s[141]++;//Error getting user form database using email to find
throw err;}));cov_56x3pjfvl.s[142]++;if(result==""){cov_56x3pjfvl.b[10][0]++;cov_56x3pjfvl.s[143]++;//Email does not exists
res.status(403).send({message:"Incorrect login credentials"});}else{cov_56x3pjfvl.b[10][1]++;cov_56x3pjfvl.s[144]++;if(result[0].user_reset_password==1){cov_56x3pjfvl.b[11][0]++;cov_56x3pjfvl.s[145]++;//Correct email but password requested to be reset. PREVENT LOGIN
res.status(403).send({message:"Password requested to be changed. Please check email for instructions."});}else{cov_56x3pjfvl.b[11][1]++;cov_56x3pjfvl.s[146]++;if(result[0].user_account_activation==0){cov_56x3pjfvl.b[12][0]++;cov_56x3pjfvl.s[147]++;//Correct email but account not activated
res.status(403).send({message:"Please check email address for link to activte your account. Once activated you can login."});}else{cov_56x3pjfvl.b[12][1]++;let encryted_data=(cov_56x3pjfvl.s[148]++,await compare(data.password,result[0].password).catch(err=>{cov_56x3pjfvl.f[42]++;cov_56x3pjfvl.s[149]++;//Error checking to see if passwords are the same
throw err;}));cov_56x3pjfvl.s[150]++;if(encryted_data==1){cov_56x3pjfvl.b[13][0]++;cov_56x3pjfvl.s[151]++;//Correct login credentials
if(result[0].new_user==1){cov_56x3pjfvl.b[14][0]++;cov_56x3pjfvl.s[152]++;//New User
res.status(409).send({new_user:1});}else{cov_56x3pjfvl.b[14][1]++;//Existing user
let userJSON=(cov_56x3pjfvl.s[153]++,toJSON(result));let data=(cov_56x3pjfvl.s[154]++,{user:userJSON,user_class:result[0].user_class,token:jwt.jwtUserSignin(userJSON),message:'Successful Login',user_name:result[0].first_name+" "+result[0].last_name});cov_56x3pjfvl.s[155]++;data=JSON.stringify(data);cov_56x3pjfvl.s[156]++;res.status(200).send(data);}}else{cov_56x3pjfvl.b[13][1]++;cov_56x3pjfvl.s[157]++;//Incorrect PW;
res.status(403).send({message:"Incorrect login credentials"});}}}}}catch(err){cov_56x3pjfvl.s[158]++;console.log(err);}},//Login New User
login_new_user:async function(req,res){cov_56x3pjfvl.f[43]++;let data;cov_56x3pjfvl.s[159]++;try{cov_56x3pjfvl.s[160]++;data=JSON.parse(req.body.data);let result=(cov_56x3pjfvl.s[161]++,await user_db.get_profile(data.email).catch(err=>{cov_56x3pjfvl.f[44]++;cov_56x3pjfvl.s[162]++;//Error getting user form database using email to find
throw err;}));cov_56x3pjfvl.s[163]++;if(result==""){cov_56x3pjfvl.b[15][0]++;cov_56x3pjfvl.s[164]++;//Email does not exists
res.status(403).send({message:"Incorrect login credentials"});}else{cov_56x3pjfvl.b[15][1]++;let encryted_data=(cov_56x3pjfvl.s[165]++,await compare(data.password,result[0].password).catch(err=>{cov_56x3pjfvl.f[45]++;cov_56x3pjfvl.s[166]++;//Error checking to see if passwords are the same
throw err;}));cov_56x3pjfvl.s[167]++;if(encryted_data==1){cov_56x3pjfvl.b[16][0]++;cov_56x3pjfvl.s[168]++;//Correct login credentials
UpdatePasswordPolicy.updateUserPassword(data.new_password,res,async function(){cov_56x3pjfvl.f[46]++;let encrypted_password=(cov_56x3pjfvl.s[169]++,await encrypt(data.new_password).catch(err=>{cov_56x3pjfvl.f[47]++;cov_56x3pjfvl.s[170]++;//Error encrypting pw
throw err;}));cov_56x3pjfvl.s[171]++;await user_db.update_user_pw(encrypted_password,data.email).catch(err=>{cov_56x3pjfvl.f[48]++;cov_56x3pjfvl.s[172]++;//Error updating user pw
throw err;});let userJSON=(cov_56x3pjfvl.s[173]++,toJSON(result));cov_56x3pjfvl.s[174]++;data={user:userJSON,user_class:result[0].user_class,token:jwt.jwtUserSignin(userJSON),message:'Successful Login',user_name:result[0].first_name+" "+result[0].last_name};cov_56x3pjfvl.s[175]++;data=JSON.stringify(data);cov_56x3pjfvl.s[176]++;res.status(200).send(data);}).catch(err=>{cov_56x3pjfvl.f[49]++;cov_56x3pjfvl.s[177]++;console.log(err);});}else{cov_56x3pjfvl.b[16][1]++;cov_56x3pjfvl.s[178]++;//Incorrect PW;
res.status(403).send({message:"Incorrect login credentials"});}}}catch(err){}},//Get Profile Information
profile_get:async function(req,res){cov_56x3pjfvl.f[50]++;let user_information;cov_56x3pjfvl.s[179]++;try{cov_56x3pjfvl.s[180]++;user_information=await user_db.get_profile(req.user.email).catch(err=>{cov_56x3pjfvl.f[51]++;cov_56x3pjfvl.s[181]++;//Error fetching user profile information from database
throw err;});cov_56x3pjfvl.s[182]++;user_information=user_information[0];cov_56x3pjfvl.s[183]++;user_information={first_name:user_information.first_name,last_name:user_information.last_name,user_country:user_information.user_country,user_city:user_information.user_city,user_district:user_information.user_district,user_street:user_information.user_street,home_phone:user_information.home_phone,mobile_phone:user_information.mobile_phone,email:user_information.email};cov_56x3pjfvl.s[184]++;user_information=JSON.stringify(user_information);cov_56x3pjfvl.s[185]++;res.status(200).send({user_information});}catch(err){cov_56x3pjfvl.s[186]++;console.log(err);cov_56x3pjfvl.s[187]++;console.log('Error trying to send profile information');}},profile_update:async function(req,res){cov_56x3pjfvl.f[52]++;let user_information;cov_56x3pjfvl.s[188]++;try{cov_56x3pjfvl.s[189]++;user_information=JSON.parse(req.body.data);cov_56x3pjfvl.s[190]++;await user_db.update_profile(user_information).catch(err=>{cov_56x3pjfvl.f[53]++;cov_56x3pjfvl.s[191]++;throw err;});let data=(cov_56x3pjfvl.s[192]++,{user_name:user_information.first_name+" "+user_information.last_name});cov_56x3pjfvl.s[193]++;data=JSON.stringify(data);cov_56x3pjfvl.s[194]++;res.status(200).send({data});}catch(err){cov_56x3pjfvl.s[195]++;console.log(err);}},profile_update_password:async function(req,res){cov_56x3pjfvl.f[54]++;let data;cov_56x3pjfvl.s[196]++;try{cov_56x3pjfvl.s[197]++;data=JSON.parse(req.body.data);let result=(cov_56x3pjfvl.s[198]++,await user_db.get_profile(req.user.email).catch(err=>{cov_56x3pjfvl.f[55]++;cov_56x3pjfvl.s[199]++;//Error getting user form database using email to find
throw err;}));let encryted_data=(cov_56x3pjfvl.s[200]++,await compare(data.current_password,result[0].password).catch(err=>{cov_56x3pjfvl.f[56]++;cov_56x3pjfvl.s[201]++;//Error checking to see if passwords are the same
throw err;}));cov_56x3pjfvl.s[202]++;if(encryted_data==1){cov_56x3pjfvl.b[17][0]++;//Correct login credentials
let encrypted_password=(cov_56x3pjfvl.s[203]++,await encrypt(data.new_password).catch(err=>{cov_56x3pjfvl.f[57]++;cov_56x3pjfvl.s[204]++;//Error encrypting pw
throw err;}));cov_56x3pjfvl.s[205]++;await user_db.update_user_pw(encrypted_password,req.user.email).catch(err=>{cov_56x3pjfvl.f[58]++;cov_56x3pjfvl.s[206]++;//Error updating user pw
throw err;});cov_56x3pjfvl.s[207]++;res.status(200).send({message:"Password Updated"});}else{cov_56x3pjfvl.b[17][1]++;cov_56x3pjfvl.s[208]++;//Incorrect PW;
res.status(403).send({message:"Incorrect password"});}}catch(err){cov_56x3pjfvl.s[209]++;console.log(err);}},reset_password_request:async function(req,res){cov_56x3pjfvl.f[59]++;cov_56x3pjfvl.s[210]++;//This sends the email to the user to reset their password
try{let result=(cov_56x3pjfvl.s[211]++,await user_db.get_profile(req.body.email).catch(err=>{cov_56x3pjfvl.f[60]++;cov_56x3pjfvl.s[212]++;//Error getting user form database using email to find
throw err;}));cov_56x3pjfvl.s[213]++;if(result==""){cov_56x3pjfvl.b[18][0]++;cov_56x3pjfvl.s[214]++;//Email does not exists (sends this message so they user will not be able to fish for emails)
res.status(403).send({message:"Check email for instructions to reset your password. If no email received ensure that email entered above is correct."});}else{cov_56x3pjfvl.b[18][1]++;cov_56x3pjfvl.s[215]++;if(result[0].user_account_activation==0){cov_56x3pjfvl.b[19][0]++;cov_56x3pjfvl.s[216]++;//Correct email but account not activated
res.status(403).send({message:"Account not activated. Please check email for activation link."});}else{cov_56x3pjfvl.b[19][1]++;cov_56x3pjfvl.s[217]++;if(result[0].user_reset_password==1){cov_56x3pjfvl.b[20][0]++;cov_56x3pjfvl.s[218]++;//Correct email but password requested to be reset. PREVENT LOGIN
res.status(403).send({message:"Password previously requested to be changed. Please check email for instructions."});}else{cov_56x3pjfvl.b[20][1]++;let user_JSON=(cov_56x3pjfvl.s[219]++,{email:`${req.body.email}`,user_id:`${result[0].id}`});let token=(cov_56x3pjfvl.s[220]++,jwt.jwt_user_reset_pw(user_JSON));var mailOptions=(cov_56x3pjfvl.s[221]++,{from:'lorawanconsole@gmail.com',to:req.body.email,subject:'Password Reset',html:`<h2>Good Day ${result[0].first_name},</h2> 
            <p>You recently requested to reset your password for your Private Marine IoT Network Web Based Console account.
            <br> Click <b><a href="http://localhost:8081/#/user/reset_password/${token}">here</a></b> to reset it. 
            <b>This password reset link is only valid for the next 24 hours.</b>
            </p>
  
            Thank You,<br>
            The Private Marine IoT Network Web Based Console Team`});cov_56x3pjfvl.s[222]++;await email.transporter.sendMail(mailOptions).catch(err=>{cov_56x3pjfvl.f[61]++;cov_56x3pjfvl.s[223]++;throw err;});cov_56x3pjfvl.s[224]++;await user_db.update_user_reset_password(req.body.email,1).catch(err=>{cov_56x3pjfvl.f[62]++;cov_56x3pjfvl.s[225]++;//Error setting user_reset_password flag
throw err;});cov_56x3pjfvl.s[226]++;await db_user_reset_password_token.create_user_reset_password_token(token,result[0].id).catch(err=>{cov_56x3pjfvl.f[63]++;cov_56x3pjfvl.s[227]++;//Error creating token in black list
throw err;});cov_56x3pjfvl.s[228]++;console.log('Email Sent');cov_56x3pjfvl.s[229]++;res.status(403).send({message:"Check email for instructions to reset your password. If no email received ensure that email entered above is correct."});}}}}catch(err){cov_56x3pjfvl.s[230]++;console.log(err);}},resend_reset_password_request:async function(req,res,token_old,user_information){cov_56x3pjfvl.f[64]++;cov_56x3pjfvl.s[231]++;//This resends the email to the user to reset their password after the initial one expired
try{cov_56x3pjfvl.s[232]++;await db_user_reset_password_token.delete_user_reset_password_token(token_old).catch(err=>{cov_56x3pjfvl.f[65]++;cov_56x3pjfvl.s[233]++;//Error creating token in black list
throw err;});let user_JSON=(cov_56x3pjfvl.s[234]++,{email:`${user_information.email}`,user_id:`${user_information.user_id}`});let token=(cov_56x3pjfvl.s[235]++,jwt.jwt_user_reset_pw(user_JSON));var mailOptions=(cov_56x3pjfvl.s[236]++,{from:'lorawanconsole@gmail.com',to:user_information.email,subject:'Password Reset',html:`<h2>Good Day,</h2> 
            <p>You recently requested to reset your password for your Private Marine IoT Network Web Based Console account.
            <br>Click <b><a href="http://localhost:8081/#/user/reset_password/${token}">here</a></b> to reset it. 
            <b>This password reset link is only valid for the next 24 hours.</b>
            </p>
  
            Thank You,<br>
            The Private Marine IoT Network Web Based Console Team`});let email_result=(cov_56x3pjfvl.s[237]++,await email.transporter.sendMail(mailOptions).catch(err=>{cov_56x3pjfvl.f[66]++;cov_56x3pjfvl.s[238]++;throw err;}));cov_56x3pjfvl.s[239]++;await db_user_reset_password_token.create_user_reset_password_token(token,user_information.user_id).catch(err=>{cov_56x3pjfvl.f[67]++;cov_56x3pjfvl.s[240]++;//Error creating token in black list 
throw err;});cov_56x3pjfvl.s[241]++;console.log('Email Sent');cov_56x3pjfvl.s[242]++;res.status(401).send({error:"Token previously expired. Please check email for new reset password link."});}catch(err){cov_56x3pjfvl.s[243]++;console.log(err);}},reset_password:async function(req,res){cov_56x3pjfvl.f[68]++;cov_56x3pjfvl.s[244]++;try{let error_location=(cov_56x3pjfvl.s[245]++,null);let password=(cov_56x3pjfvl.s[246]++,req.body.data.new_password);let result=(cov_56x3pjfvl.s[247]++,await user_db.get_profile(req.user.email).catch(err=>{cov_56x3pjfvl.f[69]++;cov_56x3pjfvl.s[248]++;//Error getting user form database using email to find
throw err;}));cov_56x3pjfvl.s[249]++;if(result==""){//Email does not exists 
cov_56x3pjfvl.b[21][0]++;}else{cov_56x3pjfvl.b[21][1]++;cov_56x3pjfvl.s[250]++;if(result[0].user_reset_password==0){cov_56x3pjfvl.b[22][0]++;cov_56x3pjfvl.s[251]++;//Correct email but password requested to be reset. PREVENT changing password again
res.status(403).send({message:"Password already updated. This is an old link!"});}else{cov_56x3pjfvl.b[22][1]++;let encrypted_password=(cov_56x3pjfvl.s[252]++,await encrypt(password).catch(err=>{cov_56x3pjfvl.f[70]++;cov_56x3pjfvl.s[253]++;//Error encrypting pw
throw err;}));cov_56x3pjfvl.s[254]++;await user_db.update_user_pw(encrypted_password,req.user.email).catch(err=>{cov_56x3pjfvl.f[71]++;cov_56x3pjfvl.s[255]++;//Error updating user pw
error_location=0;cov_56x3pjfvl.s[256]++;throw err;});cov_56x3pjfvl.s[257]++;await user_db.update_user_reset_password(req.user.email,0).catch(err=>{cov_56x3pjfvl.f[72]++;cov_56x3pjfvl.s[258]++;//Error setting user_reset_password flag
throw err;});//Password Updated.... Now we are going to login the user
let result=(cov_56x3pjfvl.s[259]++,await user_db.get_profile(req.user.email).catch(err=>{cov_56x3pjfvl.f[73]++;cov_56x3pjfvl.s[260]++;//Error getting user form database using email to find(Password updated)
error_location=1;cov_56x3pjfvl.s[261]++;throw err;}));let userJSON=(cov_56x3pjfvl.s[262]++,toJSON(result));let data=(cov_56x3pjfvl.s[263]++,{user:userJSON,user_class:result[0].user_class,token:jwt.jwtUserSignin(userJSON),message:'Successful Login',user_name:result[0].first_name+" "+result[0].last_name});let token=(cov_56x3pjfvl.s[264]++,req.headers.authorization);cov_56x3pjfvl.s[265]++;token=token.slice(7);cov_56x3pjfvl.s[266]++;await db_user_reset_password_token.delete_user_reset_password_token(token).catch(err=>{cov_56x3pjfvl.f[74]++;cov_56x3pjfvl.s[267]++;throw err;});cov_56x3pjfvl.s[268]++;res.status(200).send(data);}}}catch(err){cov_56x3pjfvl.s[269]++;console.log(err);cov_56x3pjfvl.s[270]++;if(error_location==0){cov_56x3pjfvl.b[23][0]++;cov_56x3pjfvl.s[271]++;res.status(500).send({message:"Failed update password",type:'error'});}else{cov_56x3pjfvl.b[23][1]++;cov_56x3pjfvl.s[272]++;if(error_location==1){cov_56x3pjfvl.b[24][0]++;cov_56x3pjfvl.s[273]++;res.status(200).send({message:"Password Updated. Failed to login",type:'info'});}else{cov_56x3pjfvl.b[24][1]++;cov_56x3pjfvl.s[274]++;res.status(500).send({message:'Server Error',type:'error'});}}}}};